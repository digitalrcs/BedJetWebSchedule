/*
  BedJetWebSchedule.ino  (ESP32 WROOM-32, Arduino IDE 2.3.7)


*/
/*
 * Filename:    BedJetWebSchedule.ino
 *
 * Description: Firmware entry point; This program provides the ability to connect to your bedjet and provide time of data scheduling.
 *				The initial release isn't perfect but i'm working to make it better. You can examine the code and help then please do.
 *  Lean + reliable:
 * - WiFi STA with static IP: 192.168.5.253
 * - NTP time + US Eastern TZ (EST/EDT)
 * - Web UI:
 *     * Desktop: schedule grid table
 *     * Phone: app-like schedule cards (no horizontal scrolling)
 *     * Per-item Edit (âœŽ) and Delete (ðŸ—‘)
 *     * Add/Edit dialog with hour/min/am-pm selectors
 *     * Fixes mobile <select> background/text contrast
 * - BLE (NimBLE-Arduino h2zero 2.3.7):
 *     * Connect to BedJet V3 by MAC
 *     * Send controls
 *     * Subscribe to status notifications using function callback (no callback classes)
 * Author:      Dan Roberts
 * Organization: DigitalRCS
 * Contact:     DanRoberts@DigitalRCS.Com	
 *
 * Created:     2025-12-22
 *
 * Copyright (C) 2025 Dan Roberts
 *
 * This file is part of BedJetWebSchedule. 
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 *
 * Revision History:
 *   Date       Author      Description
 *   ---------- ----------- -----------------------------------------------
 *   2025-12-22 Dan Roberts Add provisioning/config UI and BLE scheduling.
 *
 * Notes:
 *   - Full license text available in COPYING or at https://www.gnu.org/licenses/gpl-3.0.txt
 */
#include <Arduino.h>
#include <WiFi.h>
#include <ESPmDNS.h>
#include <WebServer.h>
#include <DNSServer.h>
#include <Preferences.h>
#include <time.h>
#include <NimBLEDevice.h>

// --------------------------- BLE Debug ---------------------------
#ifndef BLE_DEBUG
#define BLE_DEBUG 1
#endif
#if BLE_DEBUG
  #define BLELOG(fmt, ...) do { Serial.printf("[BLE] " fmt "\n", ##__VA_ARGS__); } while(0)
#else
  #define BLELOG(...) do {} while(0)
#endif


// --------------------------- User Config (Defaults) ---------------------------
// These are only used if no saved configuration exists.
// Use the built-in AP "BedJetSetup-XXXX" to configure on first boot/reset.
static const char* DEFAULT_WIFI_SSID = "YourWIFIName";
static const char* DEFAULT_WIFI_PASS = "YourWifiPassword";

// Default network (static). If DHCP is selected in config, these are ignored.
static IPAddress DEFAULT_LOCAL_IP(192, 168, 1, 20);
static IPAddress DEFAULT_GATEWAY (192, 168, 1, 1);
static IPAddress DEFAULT_SUBNET  (255, 255, 255, 0);
static IPAddress DEFAULT_DNS1    (192, 168, 1, 1);
static IPAddress DEFAULT_DNS2    (8, 8, 8, 8);

// Default BedJet MAC + device name
static const char* DEFAULT_BEDJET_MAC  = "AA:BB:CC:DD:EE:FF";
static const char* DEFAULT_DEVICE_NAME = "BedJetDeviceName";
static const char* DEFAULT_HOSTNAME   = "BedJetDeviceName";
// ------------------------------------------------------------------

// --------------------------- Runtime Config ---------------------------
struct RuntimeConfig {
  String   wifiSsid;
  String   wifiPass;      // stored in NVS; not echoed back to UI unless changed
  bool     useDhcp;
  IPAddress localIp;
  IPAddress gateway;
  IPAddress subnet;
  IPAddress dns1;
  IPAddress dns2;

  String   bedjetMac;     // "AA:BB:CC:DD:EE:FF"
  String   deviceName;    // used in UI/state JSON
  String   hostName;      // hostname / mDNS name (e.g., BEDJETWEB)
};

static RuntimeConfig g_cfg;

// Config portal / restart control
static DNSServer g_dns;
static bool g_configMode = false;
static uint32_t g_pendingRestartAtMs = 0;

// Store config separately from schedules
static Preferences prefsCfg;

// Forward decls (config)
static void startConfigPortal();
static void setupWebConfigPortal();
static void setupWebNormalConfigPage();
static void scheduleRestart(uint32_t delayMs = 1500);

// Forward declaration to satisfy Arduino auto-generated function prototypes
struct ScheduleItem;

// Helpers
static bool parseIp(const String& s, IPAddress& out) {
  int parts[4] = {0,0,0,0};
  int p = 0;
  String cur;
  for (size_t i = 0; i < s.length(); i++) {
    char c = s[i];
    if (c == '.') {
      if (p >= 3) return false;
      parts[p++] = cur.toInt();
      cur = "";
    } else if (isDigit((unsigned char)c)) {
      cur += c;
    } else if (c == ' ' || c == '\t' || c == '\r' || c == '\n') {
      // ignore whitespace
    } else {
      return false;
    }
  }
  parts[p] = cur.toInt();
  if (p != 3) return false;
  for (int i = 0; i < 4; i++) if (parts[i] < 0 || parts[i] > 255) return false;
  out = IPAddress(parts[0], parts[1], parts[2], parts[3]);
  return true;
}

static String normalizeMac(String mac) {
  mac.trim();
  mac.toUpperCase();
  mac.replace("-", ":");
  if (mac.length() == 12) {
    // expand AABBCCDDEEFF -> AA:BB:CC:DD:EE:FF
    String out;
    for (int i = 0; i < 12; i++) {
      out += mac[i];
      if (i % 2 == 1 && i != 11) out += ":";
    }
    return out;
  }
  return mac;
}

static String normalizeHost(String host) {
  host.trim();
  // Replace spaces/underscores with hyphens; strip invalid characters for hostname.
  host.replace(" ", "-");
  host.replace("_", "-");
  String out;
  out.reserve(host.length());
  for (size_t i = 0; i < host.length(); i++) {
    char c = host[i];
    bool ok = (c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z') ||
              (c >= '0' && c <= '9') || (c == '-') ;
    if (ok) out += c;
  }
  out.trim();
  // Hostnames can't start/end with '-' (some resolvers are picky)
  while (out.startsWith("-")) out.remove(0, 1);
  while (out.endsWith("-")) out.remove(out.length() - 1, 1);
  if (out.length() == 0) out = DEFAULT_HOSTNAME;
  // Limit length to something reasonable for mDNS / DHCP hostnames
  if (out.length() > 24) out = out.substring(0, 24);
  return out;
}


static bool isMacLikelyValid(const String& mac) {
  String m = mac;
  m.trim(); m.toUpperCase();
  if (m.length() != 17) return false;
  for (int i = 0; i < 17; i++) {
    if (i % 3 == 2) { if (m[i] != ':') return false; }
    else {
      char c = m[i];
      bool ok = (c >= '0' && c <= '9') || (c >= 'A' && c <= 'F');
      if (!ok) return false;
    }
  }
  return true;
}

static void setDefaults() {
  g_cfg.wifiSsid = DEFAULT_WIFI_SSID;
  g_cfg.wifiPass = DEFAULT_WIFI_PASS;
  g_cfg.useDhcp  = false;

  g_cfg.localIp = DEFAULT_LOCAL_IP;
  g_cfg.gateway = DEFAULT_GATEWAY;
  g_cfg.subnet  = DEFAULT_SUBNET;
  g_cfg.dns1    = DEFAULT_DNS1;
  g_cfg.dns2    = DEFAULT_DNS2;

  g_cfg.bedjetMac = DEFAULT_BEDJET_MAC;
  g_cfg.deviceName = DEFAULT_DEVICE_NAME;
  g_cfg.hostName   = DEFAULT_HOSTNAME;
}

static bool loadConfig() {
  setDefaults();

  prefsCfg.begin("cfg", true);
  String ssid = prefsCfg.getString("ssid", "");
  if (ssid.length() == 0) {
    prefsCfg.end();
    return false; // not configured
  }

  g_cfg.wifiSsid = ssid;
  g_cfg.wifiPass = prefsCfg.getString("pass", g_cfg.wifiPass);
  g_cfg.useDhcp  = prefsCfg.getBool("dhcp", g_cfg.useDhcp);

  String ip  = prefsCfg.getString("ip",  "");
  String gw  = prefsCfg.getString("gw",  "");
  String sn  = prefsCfg.getString("sn",  "");
  String d1  = prefsCfg.getString("dns1","");
  String d2  = prefsCfg.getString("dns2","");

  if (ip.length())  parseIp(ip,  g_cfg.localIp);
  if (gw.length())  parseIp(gw,  g_cfg.gateway);
  if (sn.length())  parseIp(sn,  g_cfg.subnet);
  if (d1.length())  parseIp(d1,  g_cfg.dns1);
  if (d2.length())  parseIp(d2,  g_cfg.dns2);

  g_cfg.bedjetMac  = prefsCfg.getString("mac", g_cfg.bedjetMac);
  g_cfg.deviceName = prefsCfg.getString("name", g_cfg.deviceName);
  g_cfg.hostName  = prefsCfg.getString("host", g_cfg.hostName);

  prefsCfg.end();

  g_cfg.bedjetMac = normalizeMac(g_cfg.bedjetMac);
  g_cfg.hostName = normalizeHost(g_cfg.hostName);
  return true;
}

static void saveConfigToNvs(const RuntimeConfig& cfg, bool keepPasswordIfBlank = true) {
  prefsCfg.begin("cfg", false);
  prefsCfg.putString("ssid", cfg.wifiSsid);

  if (!keepPasswordIfBlank || cfg.wifiPass.length() > 0) {
    prefsCfg.putString("pass", cfg.wifiPass);
  }

  prefsCfg.putBool("dhcp", cfg.useDhcp);

  prefsCfg.putString("ip",   cfg.localIp.toString());
  prefsCfg.putString("gw",   cfg.gateway.toString());
  prefsCfg.putString("sn",   cfg.subnet.toString());
  prefsCfg.putString("dns1", cfg.dns1.toString());
  prefsCfg.putString("dns2", cfg.dns2.toString());

  prefsCfg.putString("mac",  cfg.bedjetMac);
  prefsCfg.putString("name", cfg.deviceName);
  prefsCfg.putString("host", cfg.hostName);

  prefsCfg.end();
}
// ---------------------------------------------------------------------------

// BedJet UUIDs
static NimBLEUUID UUID_SERVICE("00001000-bed0-0080-aa55-4265644a6574");
static NimBLEUUID UUID_STATUS ("00002000-bed0-0080-aa55-4265644a6574");
static NimBLEUUID UUID_COMMAND("00002004-bed0-0080-aa55-4265644a6574");

// BedJet commands
enum BedjetCommand : uint8_t {
  CMD_BUTTON      = 0x01,
  CMD_SET_RUNTIME = 0x02, // hours, minutes
  CMD_SET_TEMP    = 0x03, // temp step
  CMD_STATUS      = 0x06,
  CMD_SET_FAN     = 0x07, // 0..19
  CMD_SET_CLOCK   = 0x08  // hours, minutes
};

// BedJet buttons
enum BedjetButton : uint8_t {
  BTN_OFF   = 0x01,
  BTN_COOL  = 0x02,
  BTN_HEAT  = 0x03,
  BTN_TURBO = 0x04,
  BTN_DRY   = 0x05,
  BTN_EXTHT = 0x06
};

static const uint8_t FAN_MIN = 0;
static const uint8_t FAN_MAX = 19;

// --------------------------- Globals ---------------------------
WebServer server(80);
Preferences prefs;

// BLE
static NimBLEClient* g_client = nullptr;
static NimBLERemoteCharacteristic* g_chrCmd = nullptr;
static NimBLERemoteCharacteristic* g_chrStatus = nullptr;
static bool g_bleConnected = false;
static bool g_bleBusy = false;

// Status snapshot (raw)
static portMUX_TYPE g_mux = portMUX_INITIALIZER_UNLOCKED;
static uint8_t  g_statusBuf[96];
static uint16_t g_statusLen = 0;
static uint32_t g_lastStatusMs = 0;
static bool     g_statusValid = false;
// Schedule
struct ScheduleItem {
  uint16_t id;
  uint8_t  modeButton;   // BedjetButton
  uint8_t  fanStep;      // 0..19
  float    tempF;
  uint16_t startMin;     // minutes from midnight local (0..1439)
  uint16_t stopMin;      // minutes from midnight local (0..1439)
  bool     enabled;
};

static const int MAX_SCHEDULE = 16;
static ScheduleItem g_sched[MAX_SCHEDULE];
static int g_schedCount = 0;
static uint16_t g_nextId = 1;

static int g_activeIndex = -1;
static uint32_t g_lastSchedulerTickMs = 0;

// --------------------------- Time Helpers ---------------------------
static bool timeValid() {
  time_t now = time(nullptr);
  return now > 1700000000; // sanity threshold
}

static bool getLocalTm(struct tm* out, uint32_t timeoutMs = 150) {
  return getLocalTime(out, timeoutMs);
}

static uint16_t minutesSinceMidnight() {
  struct tm t;
  if (!getLocalTm(&t)) return 0;
  return (uint16_t)(t.tm_hour * 60 + t.tm_min);
}

static String fmt2(int v) {
  char b[8];
  snprintf(b, sizeof(b), "%02d", v);
  return String(b);
}

static String nowString() {
  struct tm t;
  if (!getLocalTm(&t)) return "NTP sync pending";
  return String(1900 + t.tm_year) + "-" + fmt2(1 + t.tm_mon) + "-" + fmt2(t.tm_mday) +
         " " + fmt2(t.tm_hour) + ":" + fmt2(t.tm_min) + ":" + fmt2(t.tm_sec);
}

static String fmtTime12(uint16_t minOfDay) {
  int hh24 = minOfDay / 60;
  int mm = minOfDay % 60;
  bool pm = hh24 >= 12;
  int hh12 = hh24 % 12;
  if (hh12 == 0) hh12 = 12;
  char buf[16];
  snprintf(buf, sizeof(buf), "%d:%02d %s", hh12, mm, pm ? "PM" : "AM");
  return String(buf);
}

// Portable TZ offset (seconds) without tm_gmtoff
static int32_t tzOffsetSecondsNowPortable(int* outIsDst /* nullable */) {
  time_t now = time(nullptr);

  struct tm lt{};
  struct tm gt{};
  localtime_r(&now, &lt);
  gmtime_r(&now, &gt);

  if (outIsDst) *outIsDst = lt.tm_isdst;

  // Convert broken-down structs back to epoch (interpreted as local time)
  struct tm gt2 = gt;
  gt2.tm_isdst = 0;

  time_t localEpoch = mktime(&lt);
  time_t gmEpoch    = mktime(&gt2);

  return (int32_t)difftime(localEpoch, gmEpoch);
}

// --------------------------- BedJet Conversions ---------------------------
// F = 0.9 * step + 32
static float stepToF(uint8_t step) { return 0.9f * (float)step + 32.0f; }
static uint8_t fToStep(float f) {
  float step = (f - 32.0f) / 0.9f;
  if (step < 0) step = 0;
  if (step > 255) step = 255;
  return (uint8_t)lroundf(step);
}

// --------------------------- Status Buffer ---------------------------
static void setStatus(const uint8_t* data, uint16_t len, bool valid) {
  portENTER_CRITICAL(&g_mux);
  g_statusLen = (len > sizeof(g_statusBuf)) ? sizeof(g_statusBuf) : len;
  memcpy(g_statusBuf, data, g_statusLen);
  g_lastStatusMs = millis();
  g_statusValid = valid;
  portEXIT_CRITICAL(&g_mux);
}

static bool getStatusSnapshot(uint8_t* out, uint16_t& outLen, uint32_t& ageMs, bool& valid) {
  portENTER_CRITICAL(&g_mux);
  outLen = g_statusLen;
  memcpy(out, g_statusBuf, outLen);
  ageMs = millis() - g_lastStatusMs;
  valid = g_statusValid;
  portEXIT_CRITICAL(&g_mux);
  return outLen > 0;
}

// --------------------------- Notify Callback (no callback classes) ---------------------------
static void onStatusNotify(NimBLERemoteCharacteristic* chr, uint8_t* data, size_t length, bool isNotify) {
  (void)chr; (void)isNotify;
  if (!data || length < 4) return;
  bool valid = (length >= 18 && data[1] == 0x56 && data[3] == 0x01);
  setStatus(data, (uint16_t)length, valid);
}

// --------------------------- BLE Core ---------------------------
static void bleClearHandles() { g_chrCmd = nullptr; g_chrStatus = nullptr; }

static bool bleWrite(const uint8_t* bytes, size_t len) {
  if (!g_bleConnected || !g_chrCmd || len == 0) return false;
  return g_chrCmd->writeValue(bytes, len, false);
}

static bool bedjetButton(uint8_t btn) {
  uint8_t p[2] = { CMD_BUTTON, btn };
  return bleWrite(p, sizeof(p));
}

static bool bedjetSetFan(uint8_t step) {
  step = (uint8_t)constrain((int)step, (int)FAN_MIN, (int)FAN_MAX);
  uint8_t p[2] = { CMD_SET_FAN, step };
  return bleWrite(p, sizeof(p));
}

static bool bedjetSetTempF(float tempF) {
  uint8_t step = fToStep(tempF);
  uint8_t p[2] = { CMD_SET_TEMP, step };
  return bleWrite(p, sizeof(p));
}

static bool bedjetSetClockNow() {
  struct tm t;
  if (!getLocalTm(&t)) return false;
  uint8_t p[3] = { CMD_SET_CLOCK, (uint8_t)t.tm_hour, (uint8_t)t.tm_min };
  return bleWrite(p, sizeof(p));
}

static bool bedjetSetRuntimeMinutes(uint16_t minutes) {
  if (minutes > (23 * 60 + 59)) minutes = (23 * 60 + 59);
  uint8_t hrs = minutes / 60;
  uint8_t mins = minutes % 60;
  uint8_t p[3] = { CMD_SET_RUNTIME, hrs, mins };
  return bleWrite(p, sizeof(p));
}

static bool bleDisconnect() {
  if (g_bleBusy) return false;
  g_bleBusy = true;

  bool ok = true;
  if (g_client && g_client->isConnected()) ok = g_client->disconnect();

  g_bleConnected = false;
  bleClearHandles();

  g_bleBusy = false;
  return ok;
}

static bool bleResolveAddress(NimBLEAddress& outAddr) {
  // Best-effort scan to discover the BedJet with the correct address type.
  // Many BedJets advertise with RANDOM/Resolvable addresses; hard-coding PUBLIC vs RANDOM is unreliable.
  NimBLEScan* scan = NimBLEDevice::getScan();
  scan->setActiveScan(true);
  // More aggressive scan window improves odds of catching low-duty-cycle advertisements
  scan->setInterval(80);
  scan->setWindow(60);
  scan->setDuplicateFilter(false);

  // Ensure we are not already scanning (connect is more reliable when scan is stopped).
  scan->stop();
  scan->clearResults();

  const uint32_t scanSeconds = 10;

  // NimBLE-Arduino API differences: some versions return bool from start();
  // Use start() then fetch results via getResults() for broad compatibility.
  //
  // Some BedJets advertise at a low duty-cycle when idle; do two passes before giving up.
  NimBLEScanResults results;
  for (int pass = 0; pass < 2; pass++) {
    scan->stop();
    scan->clearResults();
    scan->start(scanSeconds, false);
    results = scan->getResults();
    if (results.getCount() > 0) break;
    delay(250);
  }

  String target = g_cfg.bedjetMac;
  target.toUpperCase();

  BLELOG("scan: %d results (target=%s)", results.getCount(), target.c_str());

  // 1) Exact MAC match (preferred)
  for (int i = 0; i < results.getCount(); i++) {
    const NimBLEAdvertisedDevice* dev = results.getDevice(i); if(!dev) continue;
    String addr = String(dev->getAddress().toString().c_str());
    addr.toUpperCase();
    if (addr == target) {
      outAddr = dev->getAddress(); // includes address type
      BLELOG("resolve: exact MAC match -> %s (type=%d)", outAddr.toString().c_str(), (int)outAddr.getType());
      scan->clearResults();
      return true;
    }
  }

  // 2) Service UUID match (handles cases where BedJet uses a different/random address)
  for (int i = 0; i < results.getCount(); i++) {
    const NimBLEAdvertisedDevice* dev = results.getDevice(i); if(!dev) continue;
    if (dev->isAdvertisingService(UUID_SERVICE)) {
      outAddr = dev->getAddress();
      BLELOG("resolve: service UUID match -> %s (type=%d)", outAddr.toString().c_str(), (int)outAddr.getType());
      scan->clearResults();
      return true;
    }
  }

  // 3) Name hint match (last resort)
  for (int i = 0; i < results.getCount(); i++) {
    const NimBLEAdvertisedDevice* dev = results.getDevice(i); if(!dev) continue;
    std::string n = dev->getName();
    if (n.empty()) continue;

    String name = String(n.c_str());
    String up = name;
    up.toUpperCase();

    if (up.indexOf("BEDJET") >= 0) {
      outAddr = dev->getAddress();
      BLELOG("resolve: name hint match (%s) -> %s (type=%d)", name.c_str(), outAddr.toString().c_str(), (int)outAddr.getType());
      scan->clearResults();
      return true;
    }
  }

  BLELOG("resolve: no match");
  scan->clearResults();
  return false;
}

static bool bleConnect() {
  if (g_bleBusy) return false;
  g_bleBusy = true;

  // Fast path
  if (g_client && g_client->isConnected() && g_chrCmd) {
    g_bleConnected = true;
    g_bleBusy = false;
    return true;
  }

  // Stop scan before connecting (NimBLE is more reliable this way)
  NimBLEDevice::getScan()->stop();

  const int MAX_TRIES = 6;
  bool ok = false;

  for (int attempt = 0; attempt < MAX_TRIES && !ok; attempt++) {
    BLELOG("connect: attempt %d/%d", attempt + 1, MAX_TRIES);

    if (!g_client) {
      g_client = NimBLEDevice::createClient();
      g_client->setConnectTimeout(15);

      // Connection params: keep them conservative, but not overly slow.
      // min/max in 1.25ms units -> 30ms..60ms
      g_client->setConnectionParams(24, 48, 0, 300);
    }

    // If partially connected, reset cleanly
    if (g_client->isConnected()) {
      g_client->disconnect();
      delay(200);
      bleClearHandles();
    }

    bool connected = false;

    // Prefer discovered address/type from scan
    NimBLEAddress addr(std::string(g_cfg.bedjetMac.c_str()), BLE_ADDR_PUBLIC);
    if (bleResolveAddress(addr)) {
      BLELOG("connect: trying resolved %s (type=%d)", addr.toString().c_str(), (int)addr.getType());
      connected = g_client->connect(addr);
    }

    // Fallback: explicit addr types with the configured MAC
    if (!connected) {
      for (int t = 0; t < 2 && !connected; t++) {
        uint8_t addrType = (t == 0) ? BLE_ADDR_PUBLIC : BLE_ADDR_RANDOM;
        NimBLEAddress a(std::string(g_cfg.bedjetMac.c_str()), addrType);
        BLELOG("connect: fallback try %s type=%d", a.toString().c_str(), (int)addrType);
        connected = g_client->connect(a);
        if (!connected) delay(350);
      }
    }

    if (!connected) {
      BLELOG("connect: failed (no link), resetting client");
      NimBLEDevice::deleteClient(g_client);
      g_client = nullptr;
      delay(900);
      continue;
    }

    BLELOG("connect: linked, discovering service/characteristics");
    NimBLERemoteService* svc = g_client->getService(UUID_SERVICE);
    if (!svc) {
      BLELOG("connect: service not found");
      bleDisconnect();
      delay(450);
      continue;
    }

    g_chrCmd = svc->getCharacteristic(UUID_COMMAND);
    g_chrStatus = svc->getCharacteristic(UUID_STATUS);
    if (!g_chrCmd || !g_chrStatus) {
      BLELOG("connect: characteristic(s) missing cmd=%d status=%d", (int)(g_chrCmd != nullptr), (int)(g_chrStatus != nullptr));
      bleDisconnect();
      delay(450);
      continue;
    }

    if (g_chrStatus->canNotify()) {
      BLELOG("connect: subscribing to status notifications");
      g_chrStatus->subscribe(true, onStatusNotify);
    } else {
      BLELOG("connect: status char cannot notify");
    }

    g_bleConnected = true;
    bedjetSetClockNow();
    ok = true;
    BLELOG("connect: OK");
  }

  if (!ok) {
    BLELOG("connect: giving up");
    g_bleConnected = false;
    bleClearHandles();
  }

  g_bleBusy = false;
  return ok;
}

static bool bleEnsureConnected(uint32_t waitMs = 4000) {
  // If another BLE operation is in progress, wait briefly rather than failing immediately.
  uint32_t start = millis();
  while (g_bleBusy && (millis() - start) < waitMs) {
    delay(25);
  }
  return bleConnect();
}

// --------------------------- Schedule Persistence ---------------------------

static void saveSchedule() {
  prefs.begin("bedjet", false);
  prefs.putUInt("count", (uint32_t)g_schedCount);
  prefs.putUInt("nextId", (uint32_t)g_nextId);

  for (int i = 0; i < g_schedCount; i++) {
    char key[16];
    snprintf(key, sizeof(key), "s%02d", i);

    uint8_t blob[18];
    memset(blob, 0, sizeof(blob));
    blob[0] = (uint8_t)(g_sched[i].id & 0xFF);
    blob[1] = (uint8_t)(g_sched[i].id >> 8);
    blob[2] = g_sched[i].modeButton;
    blob[3] = g_sched[i].fanStep;
    memcpy(&blob[4], &g_sched[i].tempF, sizeof(float));
    blob[8]  = (uint8_t)(g_sched[i].startMin & 0xFF);
    blob[9]  = (uint8_t)(g_sched[i].startMin >> 8);
    blob[10] = (uint8_t)(g_sched[i].stopMin & 0xFF);
    blob[11] = (uint8_t)(g_sched[i].stopMin >> 8);
    blob[12] = g_sched[i].enabled ? 1 : 0;

    prefs.putBytes(key, blob, sizeof(blob));
  }

  for (int i = g_schedCount; i < MAX_SCHEDULE; i++) {
    char key[16];
    snprintf(key, sizeof(key), "s%02d", i);
    prefs.remove(key);
  }

  prefs.end();
}

static void loadSchedule() {
  prefs.begin("bedjet", true);

  g_schedCount = (int)prefs.getUInt("count", 0);
  if (g_schedCount < 0) g_schedCount = 0;
  if (g_schedCount > MAX_SCHEDULE) g_schedCount = MAX_SCHEDULE;

  g_nextId = (uint16_t)prefs.getUInt("nextId", 1);

  for (int i = 0; i < g_schedCount; i++) {
    char key[16];
    snprintf(key, sizeof(key), "s%02d", i);

    uint8_t blob[18];
    size_t n = prefs.getBytes(key, blob, sizeof(blob));
    if (n != sizeof(blob)) continue;

    ScheduleItem it{};
    it.id = (uint16_t)blob[0] | ((uint16_t)blob[1] << 8);
    it.modeButton = blob[2];
    it.fanStep = blob[3];
    memcpy(&it.tempF, &blob[4], sizeof(float));
    it.startMin = (uint16_t)blob[8]  | ((uint16_t)blob[9]  << 8);
    it.stopMin  = (uint16_t)blob[10] | ((uint16_t)blob[11] << 8);
    it.enabled  = blob[12] ? true : false;

    g_sched[i] = it;
    if (it.id >= g_nextId) g_nextId = it.id + 1;
  }

  prefs.end();
}

// --------------------------- Scheduler Logic ---------------------------
static bool withinBlock(uint16_t nowMin, uint16_t startMin, uint16_t stopMin) {
  if (startMin == stopMin) return false;
  if (startMin < stopMin) return (nowMin >= startMin && nowMin < stopMin);
  return (nowMin >= startMin) || (nowMin < stopMin); // wraps midnight
}

static uint16_t durationMinutes(uint16_t startMin, uint16_t stopMin) {
  int d = (int)stopMin - (int)startMin;
  if (d <= 0) d += 1440;
  return (uint16_t)d;
}

static int pickActiveIndex(uint16_t nowMin) {
  for (int i = 0; i < g_schedCount; i++) {
    if (!g_sched[i].enabled) continue;
    if (withinBlock(nowMin, g_sched[i].startMin, g_sched[i].stopMin)) return i;
  }
  return -1;
}

static bool applySchedule(const ScheduleItem& it) {
  if (!bleEnsureConnected()) return false;

  bedjetSetClockNow();
  delay(40);

  if (it.modeButton == BTN_OFF) {
    return bedjetButton(BTN_OFF);
  }

  if (!bedjetButton(it.modeButton)) return false;
  delay(80);

  bedjetSetFan(it.fanStep);
  delay(60);

  bedjetSetTempF(it.tempF);
  delay(60);

  // Full block duration (recommended later: remaining duration if mid-block reboot)
  uint16_t runMins = durationMinutes(it.startMin, it.stopMin);
  bedjetSetRuntimeMinutes(runMins);

  return true;
}

static void schedulerTick() {
  if (!timeValid()) return;

  uint16_t nowMin = minutesSinceMidnight();
  int desired = pickActiveIndex(nowMin);

  if (desired == g_activeIndex) return;

  if (desired < 0) {
    if (g_activeIndex >= 0) {
      bleEnsureConnected();
      bedjetButton(BTN_OFF);
    }
    g_activeIndex = -1;
    return;
  }

  if (applySchedule(g_sched[desired])) {
    g_activeIndex = desired;
  }
}

// --------------------------- Web Helpers ---------------------------
static String jsonEscape(const String& in) {
  String out;
  out.reserve(in.length() + 16);
  for (size_t i = 0; i < in.length(); i++) {
    char c = in[i];
    if (c == '\\') out += "\\\\";
    else if (c == '"') out += "\\\"";
    else if (c == '\n') out += "\\n";
    else if (c == '\r') out += "\\r";
    else out += c;
  }
  return out;
}

static String modeName(uint8_t btn) {
  switch (btn) {
    case BTN_OFF:   return "OFF";
    case BTN_TURBO: return "TURBO";
    case BTN_HEAT:  return "HEAT";
    case BTN_COOL:  return "COOL";
    case BTN_DRY:   return "DRY";
    case BTN_EXTHT: return "EXT-HEAT";
    default:        return "UNKNOWN";
  }
}

static uint8_t modeToBtn(String s) {
  s.trim(); s.toUpperCase();
  if (s == "OFF") return BTN_OFF;
  if (s == "TURBO") return BTN_TURBO;
  if (s == "HEAT") return BTN_HEAT;
  if (s == "COOL") return BTN_COOL;
  if (s == "DRY") return BTN_DRY;
  if (s == "EXT-HEAT" || s == "EXTHT") return BTN_EXTHT;
  return BTN_OFF;
}

static String statusSummary() {
  uint8_t snap[96];
  uint16_t slen;
  uint32_t age;
  bool valid;

  if (!getStatusSnapshot(snap, slen, age, valid) || !valid) return "No status yet";

  // Observed BedJet status frame (20 bytes):
  //   [4]=hours, [5]=minutes, [6]=seconds (time remaining)
  //   [7]=actual temp byte, [8]=set temp byte
  //   [9]=mode index (0..5)
  //   [10]=fan step (0..19)
  uint8_t modeIdx = (slen > 9)  ? snap[9]  : 0;
  uint8_t fanStep = (slen > 10) ? snap[10] : 0;

  // Temperature decode: matches common community reverse-engineering & your Python script.
  auto decodeTempF = [](uint8_t b) -> int {
    int x = (int)b - 0x26;
    // F ~= (x + 66) - (x/9)
    float f = (float)(x + 66) - ((float)x / 9.0f);
    return (int)lroundf(f);
  };

  int airF = (slen > 7) ? decodeTempF(snap[7]) : 0;
  int tgtF = (slen > 8) ? decodeTempF(snap[8]) : 0;

  int fanPct = 5 + 5 * (int)fanStep; // 0->5%, 19->100%

  const char* modeStr = "unknown";
  switch (modeIdx) {
    case 0: modeStr = "off"; break;
    case 1: modeStr = "heat"; break;
    case 2: modeStr = "turbo"; break;
    case 3: modeStr = "ext-heat"; break;
    case 4: modeStr = "cool"; break;
    case 5: modeStr = "dry"; break;
    default: break;
  }

  char buf[192];
  snprintf(buf, sizeof(buf),
           "mode=%s(%u) fan=%d%% target=%dF air=%dF remaining=%u:%02u:%02u age=%ums",
           modeStr, (unsigned)modeIdx, fanPct, tgtF, airF,
           (unsigned)((slen > 4) ? snap[4] : 0),
           (unsigned)((slen > 5) ? snap[5] : 0),
           (unsigned)((slen > 6) ? snap[6] : 0),
           (unsigned)age);
  return String(buf);
}

static uint16_t activeScheduleId() {
  if (g_activeIndex < 0 || g_activeIndex >= g_schedCount) return 0;
  return g_sched[g_activeIndex].id;
}

static bool tryGetMinArg(const char* key, uint16_t& outMin) {
  String v = server.arg(key);
  v.trim();
  if (v.length() == 0) return false;
  int n = v.toInt();
  if (n < 0 || n > 1439) return false;
  outMin = (uint16_t)n;
  return true;
}

// --------------------------- JSON State ---------------------------
static String buildStateJson() {
  String timeStr = nowString();

  int isDst = -1;
  int32_t tzOff = tzOffsetSecondsNowPortable(&isDst);

  String j = "{";
  j += "\"wifi_connected\":" + String(WiFi.isConnected() ? "true" : "false") + ",";
  j += "\"ip\":\"" + jsonEscape(WiFi.localIP().toString()) + "\",";
  j += "\"time\":\"" + jsonEscape(timeStr) + "\",";
  j += "\"time_valid\":" + String(timeValid() ? "true" : "false") + ",";
  j += "\"tz_offset_sec\":" + String(tzOff) + ",";
  j += "\"dst\":" + String(isDst) + ",";
  j += "\"device_name\":\"" + jsonEscape(g_cfg.deviceName) + "\",";
  j += "\"device_mac\":\"" + jsonEscape(g_cfg.bedjetMac) + "\",";
  j += "\"ble_connected\":" + String((g_client && g_client->isConnected() && g_chrCmd) ? "true" : "false") + ",";
  j += "\"status_summary\":\"" + jsonEscape(statusSummary()) + "\",";
  j += "\"active_schedule_id\":" + String(activeScheduleId()) + ",";
  j += "\"schedule\":[";
  for (int i = 0; i < g_schedCount; i++) {
    if (i) j += ",";
    const auto& s = g_sched[i];
    j += "{";
    j += "\"id\":" + String(s.id) + ",";
    j += "\"mode\":\"" + jsonEscape(modeName(s.modeButton)) + "\",";
    j += "\"tempF\":" + String((int)lroundf(s.tempF)) + ",";
    j += "\"fan\":" + String(s.fanStep) + ",";
    j += "\"startMin\":" + String(s.startMin) + ",";
    j += "\"stopMin\":" + String(s.stopMin) + ",";
    j += "\"start\":\"" + jsonEscape(fmtTime12(s.startMin)) + "\",";
    j += "\"stop\":\"" + jsonEscape(fmtTime12(s.stopMin)) + "\",";
    j += "\"enabled\":" + String(s.enabled ? "true" : "false");
    j += "}";
  }
  j += "]";
  j += "}";
  return j;
}
// --------------------------- Schedule Import/Export ---------------------------
static String buildScheduleExportJson() {
  String j = "{";
  j += "\"schema\":1,";
  j += "\"exported\":\"" + jsonEscape(nowString()) + "\",";
  j += "\"device_name\":\"" + jsonEscape(g_cfg.deviceName) + "\",";
  j += "\"device_mac\":\"" + jsonEscape(g_cfg.bedjetMac) + "\",";
  j += "\"nextId\":" + String(g_nextId) + ",";
  j += "\"schedule\":[";
  for (int i = 0; i < g_schedCount; i++) {
    if (i) j += ",";
    const auto& s = g_sched[i];
    j += "{";
    j += "\"id\":" + String(s.id) + ",";
    j += "\"mode\":\"" + jsonEscape(modeName(s.modeButton)) + "\",";
    j += "\"tempF\":" + String((int)lroundf(s.tempF)) + ",";
    j += "\"fan\":" + String(s.fanStep) + ",";
    j += "\"startMin\":" + String(s.startMin) + ",";
    j += "\"stopMin\":" + String(s.stopMin) + ",";
    j += "\"enabled\":" + String(s.enabled ? "true" : "false");
    j += "}";
  }
  j += "]";
  j += "}";
  return j;
}

static int jsonSkipWs(const String& s, int i) {
  while (i < (int)s.length()) {
    char c = s[i];
    if (c == ' ' || c == '\r' || c == '\n' || c == '\t') i++;
    else break;
  }
  return i;
}

static bool jsonFindKey(const String& obj, const char* key, int& outPosAfterColon) {
  String k = String("\"") + key + "\"";
  int p = obj.indexOf(k);
  if (p < 0) return false;
  p = obj.indexOf(':', p + k.length());
  if (p < 0) return false;
  p++;
  p = jsonSkipWs(obj, p);
  outPosAfterColon = p;
  return true;
}

static bool jsonReadNumberToken(const String& s, int start, String& outTok) {
  int i = start;
  if (i >= (int)s.length()) return false;
  // allow leading sign
  if (s[i] == '-' || s[i] == '+') i++;
  bool any = false;
  while (i < (int)s.length()) {
    char c = s[i];
    if ((c >= '0' && c <= '9') || c == '.') { any = true; i++; }
    else break;
  }
  if (!any) return false;
  outTok = s.substring(start, i);
  outTok.trim();
  return outTok.length() > 0;
}

static bool jsonGetInt(const String& obj, const char* key, int& out) {
  int p;
  if (!jsonFindKey(obj, key, p)) return false;
  String tok;
  if (!jsonReadNumberToken(obj, p, tok)) return false;
  out = tok.toInt();
  return true;
}

static bool jsonGetFloat(const String& obj, const char* key, float& out) {
  int p;
  if (!jsonFindKey(obj, key, p)) return false;
  String tok;
  if (!jsonReadNumberToken(obj, p, tok)) return false;
  out = tok.toFloat();
  return true;
}

static bool jsonGetBool(const String& obj, const char* key, bool& out) {
  int p;
  if (!jsonFindKey(obj, key, p)) return false;
  if (obj.startsWith("true", p)) { out = true; return true; }
  if (obj.startsWith("false", p)) { out = false; return true; }
  return false;
}

static bool jsonGetString(const String& obj, const char* key, String& out) {
  int p;
  if (!jsonFindKey(obj, key, p)) return false;
  if (p >= (int)obj.length() || obj[p] != '"') return false;
  p++;
  String r;
  while (p < (int)obj.length()) {
    char c = obj[p++];
    if (c == '\\') {
      if (p >= (int)obj.length()) break;
      char e = obj[p++];
      if (e == '"' || e == '\\' || e == '/') r += e;
      else if (e == 'b') r += '\b';
      else if (e == 'f') r += '\f';
      else if (e == 'n') r += '\n';
      else if (e == 'r') r += '\r';
      else if (e == 't') r += '\t';
      else r += e;
      continue;
    }
    if (c == '"') break;
    r += c;
  }
  out = r;
  return true;
}

static bool parseScheduleImport(const String& body, ScheduleItem* outItems, int& outCount, uint16_t& outNextId, String& outErr) {
  outCount = 0;
  outNextId = 1;

  int pNext;
  int tmp;
  if (jsonGetInt(body, "nextId", tmp) && tmp > 0 && tmp < 65535) {
    outNextId = (uint16_t)tmp;
  }

  int arrKey = body.indexOf("\"schedule\"");
  if (arrKey < 0) { outErr = "missing schedule"; return false; }
  int a = body.indexOf('[', arrKey);
  if (a < 0) { outErr = "missing schedule array"; return false; }

  // Find matching ']'
  int depth = 0;
  int b = -1;
  for (int i = a; i < (int)body.length(); i++) {
    char c = body[i];
    if (c == '[') depth++;
    else if (c == ']') {
      depth--;
      if (depth == 0) { b = i; break; }
    }
  }
  if (b < 0) { outErr = "bad schedule array"; return false; }

  int i = a + 1;
  uint16_t maxId = 0;

  while (i < b) {
    i = jsonSkipWs(body, i);
    if (i >= b) break;
    if (body[i] == ',') { i++; continue; }
    if (body[i] != '{') { i++; continue; }

    // extract object substring using brace depth (no nested objects expected)
    int od = 0;
    int j = i;
    for (; j < b; j++) {
      char c = body[j];
      if (c == '{') od++;
      else if (c == '}') {
        od--;
        if (od == 0) { j++; break; }
      }
    }
    if (od != 0) { outErr = "bad object"; return false; }

    String obj = body.substring(i, j);
    i = j;

    ScheduleItem it{};
    it.id = 0;
    it.modeButton = BTN_OFF;
    it.fanStep = 10;
    it.tempF = 90;
    it.startMin = 0;
    it.stopMin = 0;
    it.enabled = true;

    int idv;
    if (jsonGetInt(obj, "id", idv) && idv > 0 && idv < 65535) it.id = (uint16_t)idv;

    String modeS;
    if (jsonGetString(obj, "mode", modeS)) {
      it.modeButton = modeToBtn(modeS);
    } else {
      int mb;
      if (jsonGetInt(obj, "modeButton", mb)) it.modeButton = (uint8_t)mb;
    }

    int fan;
    if (jsonGetInt(obj, "fan", fan) || jsonGetInt(obj, "fanStep", fan)) {
      it.fanStep = (uint8_t)constrain(fan, (int)FAN_MIN, (int)FAN_MAX);
    }
    float tf;
    if (jsonGetFloat(obj, "tempF", tf) || jsonGetFloat(obj, "temp", tf)) {
      it.tempF = tf;
    }
    int sm;
    if (jsonGetInt(obj, "startMin", sm) || jsonGetInt(obj, "start", sm)) {
      it.startMin = (uint16_t)constrain(sm, 0, 1439);
    }
    int em;
    if (jsonGetInt(obj, "stopMin", em) || jsonGetInt(obj, "stop", em)) {
      it.stopMin = (uint16_t)constrain(em, 0, 1439);
    }
    bool en;
    if (jsonGetBool(obj, "enabled", en)) it.enabled = en;

    if (it.id == 0) {
      // allocate stable IDs if missing
      it.id = outNextId++;
    }
    if (it.id > maxId) maxId = it.id;

    if (outCount >= MAX_SCHEDULE) { outErr = "too many items"; return false; }
    outItems[outCount++] = it;
  }

  // ensure nextId is sane even if caller didn't provide it
  if (outNextId <= maxId) outNextId = (uint16_t)(maxId + 1);
  if (outNextId == 0) outNextId = 1;

  return true;
}



// --------------------------- Web UI HTML ---------------------------
// --------------------------- Web UI HTML (gzipped) due to saving space on ESP32 sorry... ---------------------------
static const uint8_t INDEX_HTML_GZ[] PROGMEM = {
  0x1F, 0x8B, 0x08, 0x00, 0x7A, 0xE9, 0x4E, 0x69, 0x02, 0xFF, 0xD5, 0x3D, 0xD9, 0x6E, 0x1C, 0x49,
  0x72, 0xEF, 0xFA, 0x8A, 0x54, 0x69, 0x67, 0x55, 0x3D, 0xAC, 0x3E, 0xC9, 0xA6, 0xC8, 0x26, 0x9B,
  0x5A, 0x1D, 0x94, 0x87, 0xBB, 0xA2, 0x24, 0x8B, 0x9C, 0x85, 0xD7, 0xE3, 0x81, 0x54, 0xDD, 0x95,
  0xCD, 0x2E, 0xB1, 0x8E, 0x9E, 0xAA, 0x6A, 0x1E, 0xA2, 0x08, 0xEC, 0x17, 0x18, 0x30, 0x6C, 0xC0,
  0x2F, 0x06, 0x0C, 0xF8, 0xC1, 0xCF, 0xFB, 0x0D, 0xFB, 0x29, 0xFB, 0x05, 0xFE, 0x04, 0x47, 0x44,
  0x1E, 0x95, 0x75, 0xF4, 0x41, 0x4A, 0xBB, 0x86, 0xB1, 0x18, 0xB1, 0x2B, 0x2B, 0x33, 0x32, 0x32,
  0x32, 0xEE, 0x8C, 0xAC, 0xDD, 0x7F, 0xE8, 0xC5, 0xE3, 0xEC, 0x7A, 0xC6, 0xD9, 0x34, 0x0B, 0x83,
  0x83, 0x7D, 0xFA, 0xF7, 0xC1, 0xFE, 0x94, 0xBB, 0x1E, 0xFC, 0x09, 0x79, 0xE6, 0xB2, 0xF1, 0xD4,
  0x4D, 0x52, 0x9E, 0x0D, 0xAD, 0x79, 0x36, 0x69, 0xEE, 0x58, 0x6D, 0xD5, 0x1E, 0xB9, 0x21, 0x1F,
  0x5A, 0x17, 0x3E, 0xBF, 0x9C, 0xC5, 0x49, 0x66, 0xB1, 0x71, 0x1C, 0x65, 0x3C, 0x82, 0x7E, 0x97,
  0xBE, 0x97, 0x4D, 0x87, 0x1E, 0xBF, 0xF0, 0xC7, 0xBC, 0x49, 0x0F, 0x8E, 0x1F, 0xF9, 0x99, 0xEF,
  0x06, 0xCD, 0x74, 0xEC, 0x06, 0x7C, 0xD8, 0x75, 0xD4, 0xA8, 0xE6, 0xC4, 0xCF, 0x86, 0xE3, 0xF8,
  0x82, 0x27, 0x04, 0x37, 0xF3, 0xB3, 0x80, 0x1F, 0x3C, 0xE7, 0xDE, 0x6F, 0x79, 0xC6, 0x4E, 0xC6,
  0x53, 0xEE, 0xCD, 0x03, 0xBE, 0xDF, 0x16, 0xCD, 0x0F, 0xF6, 0xD3, 0xEC, 0x1A, 0xFF, 0x32, 0x36,
  0x48, 0xE2, 0x38, 0xBB, 0x81, 0x1F, 0x8C, 0x35, 0x9B, 0xA3, 0xB3, 0xEE, 0xE0, 0x51, 0xE7, 0x49,
  0xD7, 0xDD, 0xDC, 0xDC, 0xA3, 0xC7, 0x1E, 0x3C, 0xF6, 0x37, 0xDD, 0xBE, 0x8B, 0x8F, 0x63, 0x37,
  0xF1, 0x06, 0xC9, 0xD9, 0xC8, 0xB5, 0x7B, 0xFD, 0xBE, 0xA3, 0xFE, 0x6B, 0x75, 0x76, 0x1A, 0x7B,
  0x6A, 0x7C, 0x9C, 0x78, 0x3C, 0xA9, 0xE9, 0xD3, 0xDD, 0x6A, 0x20, 0x84, 0x8C, 0x5F, 0x65, 0x83,
  0x47, 0x7C, 0x77, 0xB2, 0x39, 0x99, 0xE0, 0x73, 0x38, 0xCF, 0xB8, 0x02, 0xB9, 0xB9, 0xE9, 0xF4,
  0xB6, 0x36, 0x45, 0xF7, 0x27, 0x3D, 0x0D, 0x32, 0x81, 0x0E, 0x8F, 0x26, 0x93, 0xCD, 0xD1, 0x96,
  0x87, 0x23, 0xCE, 0x12, 0xCE, 0xA3, 0xC1, 0xA3, 0xCD, 0xAE, 0xD7, 0x7B, 0x32, 0x56, 0x7D, 0xFC,
  0x68, 0x36, 0xCF, 0x9E, 0x9F, 0x0D, 0x18, 0x41, 0xEA, 0x38, 0xF8, 0xBF, 0x56, 0x2F, 0x47, 0x4B,
  0xBC, 0x17, 0xB8, 0xB1, 0x1A, 0xE4, 0xF2, 0x9E, 0xE9, 0xD4, 0xF5, 0xE2, 0xCB, 0x01, 0xEB, 0xB0,
  0x6E, 0x67, 0x76, 0xC5, 0x7A, 0xDB, 0xF0, 0x4F, 0x01, 0x68, 0x9F, 0xBA, 0xDE, 0x3E, 0x80, 0x7F,
  0x70, 0x7F, 0xD9, 0x0D, 0xEC, 0x55, 0x10, 0x27, 0xB0, 0x1B, 0x53, 0x1E, 0xF2, 0x01, 0xF3, 0xDC,
  0xE4, 0x7C, 0x0F, 0xDE, 0x33, 0xF6, 0xFD, 0x0D, 0x1B, 0xC5, 0x57, 0xCD, 0xD4, 0xFF, 0xEC, 0x47,
  0x67, 0x03, 0x41, 0x19, 0x20, 0xD0, 0x95, 0x78, 0x3B, 0x8A, 0xBD, 0x6B, 0x41, 0xF5, 0xD0, 0x4D,
  0xCE, 0xFC, 0x68, 0xD0, 0x11, 0x28, 0x4C, 0x60, 0xE7, 0x9B, 0x13, 0x37, 0xF4, 0x83, 0xEB, 0x41,
  0x7A, 0x9D, 0x66, 0x3C, 0x6C, 0xCE, 0x7D, 0xA7, 0xE9, 0xCE, 0x66, 0x01, 0x6F, 0x8A, 0x06, 0xE7,
  0x84, 0x9F, 0xC5, 0x9C, 0xFD, 0x78, 0xE4, 0xBC, 0x8F, 0x47, 0x71, 0x16, 0x3B, 0xCF, 0x12, 0xE0,
  0x07, 0x31, 0x9C, 0x90, 0x19, 0x5C, 0xB8, 0x89, 0x2D, 0x88, 0x2D, 0x17, 0x36, 0x72, 0xC7, 0xE7,
  0x67, 0x49, 0x3C, 0x8F, 0xBC, 0x41, 0xE0, 0x47, 0xDC, 0x4D, 0x80, 0x8E, 0xAE, 0xE7, 0x03, 0x8B,
  0xD9, 0xDD, 0x9D, 0x8E, 0xC7, 0xCF, 0x1C, 0x31, 0x04, 0xF6, 0xBF, 0xA1, 0x7F, 0xF6, 0x1A, 0x72,
  0x74, 0xE8, 0x47, 0xCD, 0x29, 0xF7, 0xCF, 0xA6, 0xD9, 0xA0, 0xDB, 0xE9, 0x5C, 0x4C, 0x25, 0xB1,
  0x2E, 0xF9, 0xE8, 0xDC, 0xCF, 0x68, 0x1A, 0x5C, 0x25, 0x6F, 0xBA, 0xDE, 0xA7, 0x79, 0x4A, 0x7D,
  0xBE, 0xD3, 0x44, 0x6A, 0x5D, 0x26, 0xEE, 0xEC, 0x06, 0x16, 0x79, 0x25, 0xD8, 0x77, 0xB0, 0xBB,
  0x03, 0x84, 0xDD, 0xD3, 0xAB, 0x66, 0xEE, 0x3C, 0x8B, 0xF7, 0xD8, 0xCC, 0xF5, 0x3C, 0x24, 0x53,
  0x77, 0x1B, 0x5F, 0xCA, 0x27, 0xA0, 0x56, 0x96, 0xC5, 0xE1, 0xA0, 0xB7, 0x33, 0x93, 0x54, 0x6B,
  0x65, 0x31, 0x00, 0xF3, 0xFC, 0x74, 0x16, 0xB8, 0xD7, 0x83, 0x49, 0xC0, 0xA1, 0xDD, 0x0D, 0xFC,
  0xB3, 0xA8, 0xE9, 0x03, 0x61, 0x52, 0x6A, 0x69, 0xA6, 0x99, 0x9B, 0x64, 0x7B, 0x0C, 0x71, 0xF1,
  0x27, 0xD7, 0x4D, 0x29, 0x4B, 0x83, 0x74, 0xE6, 0x82, 0x0C, 0x8D, 0x78, 0x76, 0x09, 0x1C, 0xB4,
  0xC7, 0xCE, 0xDC, 0xD9, 0xA0, 0xDB, 0x43, 0xC0, 0x34, 0x08, 0xD1, 0x1C, 0xE0, 0x3F, 0x0A, 0x35,
  0x35, 0xB9, 0xE8, 0x23, 0x26, 0x47, 0xD9, 0xB9, 0x11, 0x5B, 0x74, 0x29, 0xE8, 0xB1, 0xDB, 0xE9,
  0xEC, 0xB1, 0x80, 0x67, 0x19, 0xEC, 0x2D, 0x4E, 0x80, 0x6B, 0x68, 0x6D, 0x11, 0x54, 0xEC, 0x85,
  0x64, 0x19, 0xF4, 0x72, 0x08, 0xE9, 0x7C, 0x74, 0x53, 0xD8, 0x23, 0x12, 0x80, 0x86, 0xD9, 0xBB,
  0xBB, 0x99, 0x93, 0xA7, 0x09, 0xCB, 0x1D, 0xD0, 0x33, 0xEE, 0x9A, 0xDE, 0x83, 0xD6, 0x66, 0x7F,
  0x4F, 0x52, 0x77, 0x94, 0x45, 0x82, 0x8B, 0x34, 0x01, 0x91, 0x6D, 0xBB, 0x88, 0x81, 0xD8, 0x78,
  0xC1, 0x76, 0xB8, 0xD9, 0xF3, 0x54, 0xAC, 0xC5, 0x68, 0x1F, 0x74, 0xA1, 0x73, 0x1A, 0x07, 0xBE,
  0xC7, 0xE4, 0xA6, 0x53, 0x73, 0x95, 0x69, 0x6A, 0x64, 0xA6, 0xD3, 0x58, 0xCA, 0x71, 0x26, 0x91,
  0x76, 0x3A, 0x92, 0xB9, 0xC7, 0xF3, 0x24, 0x85, 0xCE, 0xB3, 0xD8, 0x87, 0x2D, 0x49, 0x44, 0x5B,
  0x16, 0xCF, 0xC7, 0xD3, 0xA6, 0x3B, 0xCE, 0xFC, 0x38, 0x1A, 0x84, 0x6E, 0xE4, 0xCF, 0xE6, 0x81,
  0x8B, 0x0F, 0x82, 0x85, 0xC4, 0x1A, 0x5B, 0xB3, 0xC4, 0x07, 0x92, 0x5C, 0xDF, 0x54, 0x90, 0xEA,
  0x6F, 0x3B, 0xDD, 0x9D, 0x9E, 0xC4, 0x69, 0xBB, 0x41, 0x74, 0xD1, 0x83, 0xE6, 0x29, 0xA8, 0x3D,
  0x41, 0x9F, 0x2C, 0x71, 0xA3, 0x74, 0x12, 0x27, 0xE1, 0x40, 0xFC, 0x84, 0x39, 0xF8, 0x1F, 0x6C,
  0xA0, 0x87, 0xC2, 0xD7, 0x0F, 0x32, 0xD4, 0x0E, 0xA3, 0x04, 0x51, 0x8E, 0x78, 0x9A, 0xDA, 0x9D,
  0xD6, 0xEE, 0x76, 0xC3, 0xC4, 0x62, 0x00, 0x8C, 0xE7, 0x8E, 0x02, 0x05, 0x32, 0xC6, 0xFD, 0xCE,
  0xAE, 0x07, 0x9D, 0x56, 0xBF, 0x5F, 0x58, 0x5F, 0x14, 0x67, 0x4D, 0x37, 0x08, 0xE2, 0x4B, 0xEE,
  0xE5, 0x72, 0x90, 0xC4, 0x97, 0x65, 0xCE, 0x5D, 0xCC, 0x82, 0x34, 0x23, 0xAA, 0x5B, 0x31, 0x13,
  0xBE, 0x1E, 0x74, 0x73, 0x61, 0x14, 0x92, 0xB4, 0xD9, 0xE9, 0xDC, 0x73, 0x3B, 0xC5, 0x5B, 0x84,
  0xDF, 0xA8, 0x65, 0x93, 0x6D, 0x05, 0x57, 0x73, 0x95, 0xC1, 0x38, 0x57, 0x4A, 0x49, 0x0A, 0x28,
  0xE2, 0x21, 0xD7, 0x8A, 0xAD, 0xF3, 0x8B, 0x7C, 0x9D, 0x67, 0x89, 0x0F, 0x5A, 0x1B, 0xFF, 0x05,
  0xDE, 0x08, 0x67, 0x48, 0x74, 0x90, 0xC7, 0x60, 0x1E, 0x46, 0x30, 0xCB, 0x13, 0x62, 0xD5, 0x49,
  0x22, 0x08, 0x81, 0x9A, 0xB6, 0xDB, 0x29, 0x4A, 0x0E, 0xF1, 0xB1, 0x20, 0xC6, 0x79, 0xBD, 0xDC,
  0xD0, 0xBB, 0x99, 0x1F, 0x04, 0x82, 0x50, 0x6A, 0x5E, 0x3F, 0x22, 0x81, 0x19, 0x05, 0xF1, 0xF8,
  0x3C, 0x57, 0x2E, 0x9B, 0x7A, 0x8A, 0xE2, 0x7A, 0x77, 0x77, 0x77, 0xD7, 0x24, 0xA4, 0x89, 0x5B,
  0x4F, 0xE3, 0x6A, 0xE8, 0x02, 0xC5, 0x2D, 0x88, 0x52, 0x2B, 0x2E, 0x21, 0x4D, 0xB6, 0xCB, 0x44,
  0xBA, 0x35, 0x72, 0xBD, 0x62, 0x97, 0x44, 0xAE, 0x0A, 0x7B, 0x88, 0x45, 0xD4, 0x32, 0x0D, 0x2D,
  0xC2, 0x54, 0x7C, 0x63, 0x4E, 0x12, 0x55, 0xC3, 0x48, 0x00, 0xA9, 0xFD, 0x3D, 0x3B, 0x42, 0x0B,
  0x98, 0xB2, 0x36, 0x3B, 0xE1, 0x01, 0x1F, 0xC3, 0x2F, 0x7B, 0xE2, 0x5F, 0x31, 0x2F, 0x89, 0x67,
  0xB0, 0x79, 0x91, 0xC1, 0x1B, 0x6D, 0x92, 0x61, 0xF6, 0x7D, 0x1B, 0xC6, 0x91, 0xD9, 0x74, 0x58,
  0x4A, 0x43, 0x04, 0x81, 0x05, 0xE7, 0x29, 0x0D, 0x5F, 0x54, 0x3B, 0xF7, 0xD2, 0x38, 0x86, 0x69,
  0x5E, 0xC4, 0xA7, 0xD2, 0xBA, 0xAF, 0xA1, 0x6F, 0xC4, 0xC6, 0x90, 0x09, 0x81, 0x35, 0xCF, 0x12,
  0x7E, 0x01, 0x64, 0x49, 0x99, 0xFF, 0xF6, 0x84, 0x7D, 0x8E, 0xE3, 0x50, 0xAC, 0x8A, 0x95, 0x94,
  0x69, 0x4F, 0x00, 0x88, 0xE7, 0x19, 0xB6, 0x83, 0xF0, 0x46, 0x5C, 0x6D, 0x23, 0xCD, 0x3C, 0x18,
  0x00, 0xF5, 0xC7, 0x7C, 0x1A, 0x07, 0x80, 0xA3, 0xDA, 0x2D, 0x56, 0xF5, 0x59, 0xFA, 0x7D, 0xB5,
  0x73, 0x26, 0xC1, 0x94, 0x95, 0x04, 0x03, 0x0E, 0x66, 0xD7, 0x8D, 0xC6, 0x72, 0x06, 0xD6, 0x0C,
  0xE3, 0xCF, 0xD5, 0xD6, 0x72, 0x83, 0x49, 0xE4, 0x26, 0xA9, 0xA6, 0xC1, 0xA6, 0x96, 0xCE, 0x9C,
  0x52, 0x4D, 0xD0, 0x8E, 0x67, 0x7C, 0x40, 0xAD, 0x62, 0x7D, 0xA6, 0x89, 0xDF, 0xEA, 0xA3, 0x85,
  0x17, 0x7A, 0x6F, 0xE6, 0x26, 0xD0, 0xC4, 0xFA, 0x9D, 0xEF, 0x9C, 0x9A, 0x35, 0xEC, 0xF4, 0x1B,
  0xF8, 0xAA, 0xE1, 0x2C, 0x80, 0xD4, 0xDD, 0x14, 0xA0, 0x16, 0x8E, 0xAC, 0xCC, 0xB2, 0x10, 0x54,
  0x16, 0x33, 0x5A, 0x4F, 0x61, 0x44, 0xE1, 0xA1, 0xC2, 0x0F, 0xCD, 0x59, 0x9C, 0xFA, 0x64, 0x27,
  0x24, 0x4C, 0xF0, 0x80, 0xC7, 0x36, 0x32, 0x23, 0x6B, 0xB2, 0x1E, 0x70, 0x60, 0x43, 0xB4, 0xF4,
  0xA9, 0x01, 0xA4, 0x5D, 0x4F, 0x6E, 0x76, 0x44, 0xA5, 0xB2, 0xB0, 0x63, 0x87, 0x75, 0x2A, 0xB3,
  0x12, 0x57, 0xA1, 0x7A, 0x82, 0xFF, 0x1C, 0xA6, 0x7F, 0x10, 0xB8, 0x5C, 0x12, 0x8C, 0x01, 0x09,
  0x87, 0x4D, 0xCC, 0x60, 0x03, 0xE5, 0x2F, 0xC5, 0x4E, 0x82, 0x2F, 0xC0, 0x6E, 0xE0, 0x1A, 0x0A,
  0xA6, 0xEC, 0x51, 0x67, 0xD4, 0xDB, 0xDA, 0x02, 0x9F, 0xBB, 0xCA, 0xDD, 0x82, 0xA5, 0x04, 0x27,
  0x4E, 0xE2, 0xF1, 0x3C, 0x55, 0x02, 0x29, 0x9E, 0x6E, 0x4C, 0xA1, 0x33, 0x79, 0xD3, 0x34, 0x8C,
  0x5B, 0xFD, 0x46, 0x45, 0x7B, 0xE3, 0x52, 0xE1, 0x7F, 0x9B, 0xCA, 0xC1, 0x2D, 0x18, 0xD2, 0x8E,
  0xA1, 0xCF, 0x7D, 0x70, 0xA0, 0xB4, 0x9B, 0x21, 0x2D, 0x0F, 0x39, 0x64, 0x52, 0x82, 0xC4, 0xC3,
  0x5F, 0xCD, 0xD1, 0xD0, 0xD1, 0xC5, 0x02, 0xC1, 0xAF, 0xF3, 0x29, 0x4A, 0x66, 0xA0, 0xEA, 0x27,
  0x2A, 0x75, 0x59, 0xF6, 0x11, 0x65, 0x7B, 0xD5, 0x31, 0x61, 0x65, 0xCF, 0x84, 0x2D, 0x54, 0xFD,
  0x92, 0x5E, 0x2D, 0xCF, 0x8D, 0xCE, 0x50, 0x61, 0xD4, 0xAD, 0xAE, 0xBF, 0xEB, 0x3C, 0x79, 0x22,
  0xA3, 0xA2, 0xC2, 0xDE, 0x95, 0x7B, 0x6C, 0xF6, 0x94, 0xBD, 0x40, 0xB0, 0x8B, 0x7C, 0x08, 0x32,
  0x07, 0xE5, 0xB5, 0x90, 0x29, 0xE0, 0x91, 0x27, 0x39, 0xC8, 0x83, 0x18, 0x21, 0x3E, 0x33, 0x77,
  0x11, 0x3C, 0x09, 0xD8, 0x75, 0x18, 0xEB, 0xEC, 0xF6, 0x2E, 0x2E, 0x57, 0x78, 0x02, 0x77, 0xDC,
  0xC7, 0x05, 0x51, 0x86, 0x60, 0xB5, 0x27, 0x4E, 0x6F, 0xDB, 0xE9, 0x77, 0x1D, 0xF4, 0xAF, 0x64,
  0x13, 0x2C, 0x78, 0xC7, 0xD9, 0xED, 0x50, 0xD3, 0xF2, 0xFD, 0xD6, 0x16, 0x47, 0xFA, 0xB8, 0x48,
  0x9C, 0xC0, 0x1D, 0xF1, 0x20, 0xA7, 0x8C, 0x34, 0xFB, 0x65, 0x9F, 0xBA, 0xCE, 0x7F, 0x28, 0xFA,
  0xFA, 0xDB, 0xC2, 0xDD, 0x40, 0x72, 0xA3, 0xAB, 0xB8, 0x94, 0xDC, 0xF5, 0x51, 0x83, 0xF0, 0xBF,
  0x3B, 0x72, 0xCF, 0xA6, 0x6E, 0x30, 0xB9, 0x51, 0xDE, 0x9B, 0xE1, 0xB9, 0xF5, 0xB6, 0x3A, 0x79,
  0x48, 0x30, 0xF3, 0x41, 0x17, 0x88, 0xF6, 0x1D, 0xED, 0xEF, 0x08, 0x11, 0x6F, 0xFD, 0x32, 0x16,
  0xF6, 0x5A, 0x75, 0xE8, 0xB7, 0xB6, 0x78, 0x68, 0x42, 0x52, 0x33, 0x41, 0x8B, 0x7F, 0x53, 0xF1,
  0x4E, 0x96, 0xAC, 0x18, 0x23, 0x8B, 0x6D, 0x23, 0xB2, 0x09, 0x39, 0x7A, 0x69, 0x6B, 0x7A, 0x6E,
  0x93, 0x84, 0xC9, 0xFF, 0x4C, 0x8A, 0x28, 0x5F, 0xE3, 0x25, 0x4F, 0xCF, 0x01, 0x3C, 0x4B, 0x65,
  0xD2, 0x81, 0x65, 0xE8, 0x34, 0x0B, 0xE3, 0xDB, 0xA2, 0xDF, 0x22, 0x26, 0xC4, 0x54, 0xC5, 0x04,
  0xBC, 0xE4, 0xE6, 0xD5, 0x40, 0x04, 0x81, 0xCA, 0x56, 0xEA, 0x17, 0xE9, 0x38, 0x89, 0x83, 0x00,
  0x77, 0x9B, 0x84, 0xB1, 0x56, 0xCB, 0xD0, 0x02, 0x08, 0xEA, 0x8D, 0xE9, 0x9D, 0x18, 0x62, 0x15,
  0xB8, 0xB3, 0x94, 0x0F, 0xD4, 0x8F, 0x02, 0x05, 0x76, 0xEA, 0xFC, 0xCD, 0x9C, 0xBA, 0x4F, 0xB6,
  0xF5, 0x3E, 0x65, 0x53, 0x27, 0x03, 0xF2, 0x14, 0xC2, 0x2C, 0x53, 0xF1, 0xA9, 0x68, 0x51, 0xCB,
  0x47, 0x7D, 0xC8, 0xC4, 0x28, 0x5A, 0x26, 0x55, 0x34, 0x08, 0xF8, 0x04, 0xC2, 0xD4, 0xCB, 0x29,
  0xA8, 0x24, 0x8A, 0x1D, 0xD1, 0xE4, 0xE7, 0xEE, 0x7F, 0x36, 0x5D, 0x12, 0x29, 0x9A, 0xD1, 0xA7,
  0x22, 0xFB, 0xBB, 0x29, 0x38, 0x0C, 0xCC, 0x02, 0x0F, 0xA2, 0x19, 0xF8, 0xE7, 0xDC, 0xCA, 0xE9,
  0x8F, 0x8E, 0x7E, 0x2A, 0xE9, 0x4F, 0xBF, 0xF3, 0x6D, 0x16, 0x5E, 0x87, 0x41, 0x91, 0xAE, 0xC1,
  0x99, 0x79, 0x00, 0x52, 0x91, 0xFE, 0xFA, 0x0C, 0xCF, 0x1A, 0xDA, 0x7C, 0xFB, 0x6B, 0x22, 0x0E,
  0xB0, 0x57, 0x3B, 0x98, 0x95, 0xE9, 0x95, 0xB3, 0x32, 0x2A, 0x5D, 0x54, 0x0A, 0xDD, 0x3B, 0xB9,
  0x8A, 0x10, 0xAB, 0x39, 0x5D, 0x9E, 0x3E, 0x58, 0x64, 0x16, 0xEA, 0x52, 0x07, 0x25, 0x3A, 0x9D,
  0xD6, 0xE4, 0x06, 0xFA, 0x35, 0xB9, 0x81, 0x3C, 0x17, 0x00, 0xBE, 0xFF, 0x19, 0xBF, 0xB9, 0x9B,
  0xBD, 0xC2, 0x99, 0x77, 0xCA, 0xA4, 0xDA, 0xBE, 0x47, 0x58, 0x73, 0x87, 0xFD, 0x93, 0x34, 0xD6,
  0x49, 0xB2, 0x35, 0x42, 0x20, 0x56, 0xC7, 0xB9, 0x3A, 0x90, 0xC6, 0x75, 0xB7, 0xD0, 0x01, 0x92,
  0xEE, 0x4A, 0x4D, 0x70, 0x44, 0x24, 0xFD, 0x3B, 0x54, 0x48, 0x05, 0xFA, 0x90, 0x52, 0xA2, 0x96,
  0x7A, 0xC5, 0xA4, 0xB5, 0x92, 0xE8, 0x23, 0x88, 0xC5, 0x72, 0x56, 0x2A, 0xF3, 0x79, 0x79, 0x3D,
  0x5B, 0x05, 0x7E, 0xF9, 0xDD, 0xCA, 0x54, 0x4D, 0xCF, 0x48, 0xD5, 0xA8, 0x5C, 0x95, 0xC1, 0x16,
  0xBF, 0x2F, 0xF2, 0xC3, 0x4E, 0xBF, 0xA3, 0x5F, 0x3D, 0x23, 0xB7, 0x22, 0xBD, 0x8F, 0x35, 0xAF,
  0x11, 0x56, 0xA1, 0x00, 0x8E, 0xE3, 0x91, 0x8F, 0xDA, 0xF6, 0x92, 0xBB, 0xE7, 0x52, 0xDC, 0x7F,
  0x13, 0x72, 0xB0, 0xFB, 0xCC, 0xCE, 0xD3, 0x6F, 0xEC, 0x09, 0x39, 0xCA, 0x82, 0xAE, 0x32, 0x39,
  0x57, 0x90, 0xB9, 0x4A, 0xF2, 0x4D, 0xAF, 0xA8, 0x94, 0x01, 0x13, 0xB9, 0xAD, 0x8E, 0xF1, 0x96,
  0xB2, 0x5B, 0x26, 0x79, 0x5A, 0x7D, 0xE3, 0x2D, 0xE6, 0x05, 0x16, 0xD8, 0x93, 0x4D, 0x9D, 0x09,
  0x28, 0xDB, 0x6C, 0x39, 0x96, 0x34, 0x91, 0xA1, 0x98, 0x0B, 0x2A, 0x5E, 0xE9, 0x90, 0x1D, 0x63,
  0x00, 0x3A, 0xAC, 0xA5, 0x9C, 0x58, 0xAF, 0xC6, 0x4D, 0xDD, 0xCA, 0x87, 0x48, 0xFF, 0xA8, 0xEA,
  0x1B, 0x6D, 0xA3, 0x6F, 0x24, 0x88, 0x4C, 0x64, 0x3E, 0xB9, 0xF4, 0xB3, 0xF1, 0x34, 0xD7, 0xAE,
  0x98, 0x7F, 0x1F, 0x48, 0x1D, 0xEB, 0x47, 0x69, 0xC6, 0x5D, 0x8F, 0xC5, 0x13, 0xD3, 0xE8, 0x15,
  0xCD, 0x5E, 0x51, 0xF5, 0x1A, 0x0B, 0x4C, 0x2B, 0x1E, 0x8C, 0x78, 0x29, 0x8D, 0x5B, 0x79, 0x9C,
  0xC2, 0xE7, 0xD8, 0x3D, 0x87, 0x4D, 0x07, 0x7B, 0x3B, 0x9A, 0xC3, 0x86, 0x45, 0x29, 0xE3, 0x6E,
  0xEA, 0xF3, 0x44, 0x4F, 0xAD, 0xFC, 0x77, 0xB9, 0xB2, 0xAD, 0x9E, 0xE1, 0xBB, 0x6F, 0xAD, 0x20,
  0xCA, 0x42, 0x37, 0xA4, 0x83, 0x6E, 0xC8, 0xAD, 0x8A, 0x11, 0x90, 0x2A, 0xA1, 0x1B, 0x04, 0x30,
  0xEB, 0x0C, 0xAD, 0xD0, 0x62, 0xEE, 0xDB, 0xDC, 0x35, 0xB8, 0x2F, 0x97, 0xF2, 0x25, 0xF2, 0x9C,
  0x73, 0x97, 0xE1, 0x28, 0x3D, 0x59, 0x8D, 0xE3, 0x56, 0x6B, 0xBB, 0x8C, 0xE3, 0x8B, 0x38, 0x8A,
  0x30, 0x00, 0x0B, 0x63, 0xCF, 0x0D, 0x04, 0x8A, 0x8F, 0x80, 0x38, 0xD1, 0xCB, 0xA0, 0xB0, 0xEF,
  0x5B, 0xBD, 0xDC, 0x27, 0xCE, 0x7D, 0xB4, 0x08, 0x7C, 0x79, 0xC3, 0x79, 0x16, 0x8C, 0x2F, 0xC9,
  0xD8, 0xAB, 0xD1, 0xBE, 0x7D, 0x1D, 0x18, 0x0A, 0xDD, 0xBB, 0x59, 0xD2, 0xBD, 0x66, 0xF0, 0xAC,
  0xED, 0x97, 0x04, 0x01, 0xBB, 0xD9, 0x5C, 0x98, 0x67, 0xD8, 0x55, 0xC1, 0x1C, 0x44, 0x24, 0xA1,
  0x2B, 0xA2, 0x13, 0x44, 0x90, 0xB5, 0x76, 0x53, 0x19, 0x65, 0x03, 0x1F, 0x4E, 0xF0, 0x98, 0x48,
  0x27, 0x32, 0x7E, 0x73, 0xCE, 0xAF, 0x27, 0x89, 0x1B, 0xC2, 0xCE, 0x08, 0x32, 0x66, 0xF1, 0x8D,
  0x99, 0x12, 0x4D, 0xE2, 0x0C, 0xE8, 0x6E, 0x6F, 0x6E, 0xA3, 0x97, 0xDE, 0xD8, 0xBB, 0x45, 0x92,
  0xED, 0xB7, 0xE5, 0x19, 0xD1, 0x7E, 0x5B, 0x1E, 0x61, 0xE1, 0x99, 0x05, 0xFC, 0xF1, 0xFC, 0x0B,
  0x36, 0x0E, 0xDC, 0x34, 0x1D, 0x5A, 0xC8, 0xD1, 0x16, 0x9E, 0x22, 0x99, 0x8D, 0x80, 0x3D, 0xB5,
  0x89, 0xD6, 0x03, 0x19, 0x59, 0x17, 0x7A, 0xA0, 0x1A, 0xB1, 0x0E, 0x9E, 0x1F, 0xBE, 0xFC, 0xED,
  0xE1, 0x29, 0xFB, 0xCB, 0x1F, 0xFF, 0xCD, 0x38, 0xA0, 0x5A, 0x30, 0x04, 0x74, 0x8B, 0x75, 0x20,
  0x37, 0x90, 0x7B, 0xE0, 0x63, 0xE2, 0x89, 0xD8, 0x80, 0xED, 0x83, 0x61, 0x8D, 0x98, 0xEF, 0x0D,
  0x2D, 0x8F, 0x5F, 0x58, 0x07, 0x4D, 0x40, 0x1A, 0x1A, 0x0E, 0x00, 0xE6, 0x7F, 0x19, 0xEF, 0x42,
  0x77, 0x9C, 0xBF, 0x5B, 0x3E, 0x85, 0x6C, 0x67, 0xEC, 0xD4, 0x0F, 0x0B, 0xF0, 0xD1, 0x45, 0x7E,
  0x13, 0x5F, 0xE6, 0x70, 0x74, 0x4F, 0x9C, 0xEB, 0xCD, 0xE9, 0x3B, 0xB3, 0x73, 0x94, 0xCD, 0x16,
  0x74, 0x7C, 0xFE, 0xFA, 0xD0, 0xEC, 0x38, 0x42, 0x3A, 0xD4, 0x76, 0x3C, 0xFD, 0x47, 0xF6, 0x76,
  0x32, 0x49, 0x79, 0x56, 0x40, 0xE2, 0x73, 0xA5, 0xB7, 0xB1, 0x1C, 0xF3, 0xA7, 0xB1, 0x2E, 0xE1,
  0x55, 0xE8, 0xA5, 0xED, 0x0B, 0x3D, 0xA1, 0xDE, 0x82, 0x6A, 0x60, 0x32, 0xBB, 0x6E, 0xB1, 0x38,
  0x1A, 0x07, 0xFE, 0xF8, 0x9C, 0xF0, 0x92, 0xC4, 0xB6, 0xB3, 0xA9, 0x9F, 0x36, 0x34, 0xED, 0xF7,
  0xDB, 0x62, 0xF8, 0x62, 0x68, 0x45, 0x28, 0x2F, 0xFD, 0x74, 0x5C, 0x04, 0x94, 0xB7, 0xDC, 0x09,
  0x96, 0x17, 0xBF, 0xE7, 0x93, 0x84, 0xA7, 0x53, 0x05, 0x47, 0x3E, 0x96, 0x81, 0x10, 0x20, 0xB7,
  0x00, 0x63, 0x9A, 0xF0, 0xC9, 0xD0, 0x6A, 0xC3, 0xAC, 0x13, 0xFF, 0x8C, 0x56, 0x02, 0x7F, 0xF7,
  0xDB, 0x2E, 0xB2, 0xB6, 0xA4, 0x98, 0xFC, 0x51, 0xE2, 0xE4, 0x04, 0xF7, 0xBB, 0x42, 0x4F, 0xD4,
  0x5A, 0x56, 0x1D, 0x03, 0x9D, 0x5F, 0x18, 0xFC, 0x53, 0x78, 0x61, 0x1D, 0x1C, 0x9E, 0xBC, 0xDB,
  0xEC, 0xB1, 0xA3, 0x77, 0x62, 0x22, 0x7A, 0x89, 0x1B, 0xEA, 0x0B, 0x3E, 0x31, 0x38, 0xB2, 0x32,
  0x52, 0x89, 0x06, 0x3B, 0x41, 0x19, 0x2D, 0x8D, 0x27, 0x2B, 0x44, 0x2F, 0x56, 0xC2, 0x51, 0x47,
  0xC1, 0xD0, 0x79, 0x9E, 0x96, 0xC1, 0x50, 0x63, 0x19, 0x44, 0x95, 0xB5, 0xD6, 0xA0, 0x05, 0x29,
  0x8D, 0xA1, 0x55, 0x71, 0x84, 0x6B, 0x5C, 0x73, 0xEB, 0xE0, 0xEF, 0xE7, 0xB0, 0xB7, 0xA8, 0x97,
  0x33, 0x08, 0xF4, 0xD2, 0x85, 0x92, 0x59, 0xE2, 0xE0, 0x55, 0x5C, 0x97, 0x45, 0xF6, 0xE3, 0xB7,
  0xAF, 0x5E, 0x3D, 0x76, 0x98, 0x64, 0x15, 0x78, 0xA8, 0xB2, 0xC9, 0x6A, 0x18, 0xA7, 0x3F, 0xBE,
  0x7F, 0xFE, 0x36, 0x87, 0x42, 0x8F, 0xF7, 0x81, 0xF3, 0xC3, 0xE1, 0xB3, 0xD3, 0x1C, 0x0C, 0x3E,
  0xDD, 0x07, 0xCA, 0x8B, 0xB7, 0x6F, 0x5F, 0xE7, 0x50, 0xF0, 0xE9, 0x3E, 0x50, 0x5E, 0xBE, 0xFF,
  0x43, 0x0E, 0x04, 0x1E, 0xEE, 0x03, 0xE3, 0xF0, 0x1F, 0x4E, 0x9B, 0xC5, 0x35, 0xA9, 0x96, 0x8A,
  0x44, 0x1B, 0x6C, 0x53, 0xDC, 0x52, 0x99, 0x5F, 0xB1, 0x14, 0xBF, 0x94, 0xBD, 0xDA, 0x05, 0x92,
  0x84, 0x19, 0x15, 0xAB, 0x20, 0xEA, 0x94, 0xFB, 0x91, 0x8C, 0xF4, 0x0A, 0xD4, 0xE4, 0x49, 0xC6,
  0x67, 0xCC, 0xEE, 0xFC, 0xE5, 0x8F, 0xFF, 0xDA, 0xDD, 0x6D, 0xEC, 0xB7, 0xC5, 0x6B, 0x73, 0xC0,
  0x32, 0xBE, 0x5A, 0xB9, 0x7E, 0xB4, 0x9E, 0xF6, 0xE3, 0x5F, 0x60, 0xA2, 0xC7, 0x4E, 0xB3, 0xDB,
  0x20, 0x89, 0xA9, 0xEA, 0x1F, 0x00, 0x42, 0x09, 0x5B, 0x92, 0x2D, 0xEC, 0x6C, 0x69, 0x1B, 0x03,
  0xE3, 0x2D, 0x88, 0x78, 0x82, 0x39, 0xAC, 0xB9, 0xDB, 0xB1, 0x44, 0x62, 0x17, 0x1C, 0x12, 0x78,
  0x8C, 0xE6, 0x21, 0x4F, 0xFC, 0x31, 0x56, 0x6F, 0xDC, 0x0B, 0x9F, 0x0D, 0xC4, 0x67, 0xA3, 0x56,
  0x1F, 0x16, 0x15, 0x43, 0x91, 0x08, 0x98, 0x3A, 0xB2, 0x0E, 0x3A, 0xC3, 0xFE, 0x77, 0x60, 0x77,
  0xFE, 0x9B, 0x75, 0x77, 0x87, 0xE8, 0x5D, 0x97, 0x75, 0x49, 0x61, 0x23, 0xEF, 0xB2, 0x27, 0xA7,
  0xE0, 0xD4, 0x31, 0xFB, 0xCF, 0x7F, 0x7A, 0xF5, 0x57, 0xDB, 0x0C, 0x9C, 0x61, 0xFD, 0xDD, 0xC0,
  0xDE, 0xF5, 0xDB, 0xB1, 0xFB, 0xCD, 0xB6, 0x43, 0x60, 0xB4, 0xF6, 0x7E, 0xD4, 0x29, 0xDD, 0x6F,
  0x20, 0x32, 0x4A, 0x13, 0x8B, 0xF4, 0xE3, 0xE2, 0x1D, 0x7A, 0x3F, 0x8F, 0xC8, 0xDB, 0xB9, 0xD7,
  0xFE, 0xC8, 0x33, 0x0D, 0x22, 0x2D, 0x00, 0xFA, 0x41, 0x93, 0x56, 0xF9, 0xE3, 0x16, 0x38, 0x5C,
  0xA2, 0x53, 0x69, 0x64, 0x99, 0x05, 0x8B, 0xCB, 0x1A, 0x74, 0xF0, 0x94, 0x05, 0xB0, 0x9E, 0x26,
  0x15, 0xEE, 0xAD, 0x4E, 0x7B, 0xFC, 0xAD, 0xA6, 0x6D, 0x62, 0x52, 0x6E, 0x20, 0x66, 0x86, 0xD7,
  0x55, 0xC1, 0x59, 0x2D, 0x49, 0xAF, 0xB9, 0x7B, 0xC1, 0x99, 0x9B, 0xB1, 0x0E, 0x38, 0x1E, 0xAC,
  0x0D, 0x7F, 0xA0, 0x1D, 0x1C, 0x6E, 0x16, 0xC5, 0x19, 0x16, 0x80, 0x45, 0x67, 0x9C, 0x25, 0xF3,
  0x08, 0xFD, 0xC9, 0xD6, 0xFD, 0x18, 0x41, 0xCC, 0xA3, 0xFC, 0x82, 0x04, 0x0F, 0x0D, 0x03, 0x1F,
  0x5C, 0x7B, 0x8A, 0x1A, 0x53, 0xAA, 0xA8, 0xC1, 0xC0, 0x60, 0x0C, 0x11, 0xD9, 0x75, 0xAB, 0xCE,
  0x3F, 0xAC, 0xF7, 0x76, 0xC8, 0x96, 0xD7, 0x31, 0x57, 0x2F, 0x67, 0xAE, 0x1A, 0x86, 0x50, 0x23,
  0x96, 0x27, 0xCD, 0xD6, 0x72, 0x12, 0xF2, 0x45, 0x7D, 0x23, 0x57, 0x80, 0x5F, 0x61, 0x65, 0x9C,
  0x02, 0x6A, 0x6B, 0x6B, 0xF5, 0xEE, 0xED, 0xFB, 0xBB, 0xDA, 0xE0, 0x78, 0xC6, 0xA3, 0xA3, 0x10,
  0xC1, 0x29, 0x30, 0x47, 0xC7, 0xEB, 0x82, 0xA9, 0x71, 0xB0, 0x11, 0xDC, 0x33, 0xCF, 0xB3, 0x01,
  0xCE, 0xB3, 0x97, 0x2F, 0x17, 0xD8, 0xCD, 0x8A, 0xE7, 0xF5, 0xB0, 0xD9, 0xD4, 0xE9, 0x75, 0x0C,
  0x99, 0x59, 0xB3, 0x59, 0xDD, 0x17, 0x9D, 0x6B, 0xC8, 0x69, 0x4E, 0x4D, 0x06, 0x86, 0x99, 0x88,
  0xE8, 0x0C, 0x36, 0xCE, 0x92, 0x92, 0x9C, 0x64, 0x53, 0xB5, 0x4B, 0x22, 0xE0, 0xDD, 0x16, 0x2A,
  0xE6, 0xD1, 0x7E, 0x3B, 0x9B, 0x56, 0xBA, 0x1E, 0x1C, 0x83, 0xCA, 0xAC, 0x7F, 0x83, 0xBA, 0xB0,
  0xFE, 0x0D, 0x18, 0xAD, 0xFA, 0x17, 0x27, 0x58, 0xC0, 0xB5, 0xE8, 0x55, 0xBC, 0x00, 0xDA, 0x61,
  0x44, 0xA5, 0x39, 0xB5, 0x2F, 0x8B, 0x2B, 0xE9, 0x8A, 0xB4, 0x99, 0x91, 0x89, 0xA7, 0x83, 0x68,
  0x58, 0x9C, 0xCC, 0xCA, 0x95, 0x61, 0xC0, 0x73, 0x62, 0x0A, 0x69, 0x89, 0x7A, 0xFB, 0x19, 0x06,
  0xC6, 0xA4, 0x8B, 0x40, 0x3D, 0xA7, 0xA8, 0x79, 0x32, 0x11, 0x2A, 0xEB, 0x01, 0x39, 0xF9, 0x2B,
  0xDB, 0x29, 0xB3, 0x76, 0x2A, 0x6D, 0x2F, 0x13, 0x49, 0x85, 0x7D, 0x45, 0xC8, 0xD4, 0x6C, 0x99,
  0xA2, 0x4A, 0x13, 0x15, 0x05, 0x5A, 0x01, 0xC7, 0x18, 0x1D, 0xB3, 0x59, 0x62, 0xA4, 0xC8, 0x70,
  0xE4, 0x61, 0xFA, 0x42, 0xE1, 0x83, 0xD8, 0x54, 0xE5, 0x48, 0x80, 0x0C, 0x39, 0xF0, 0xC5, 0x32,
  0x5F, 0xC9, 0x45, 0xEA, 0x92, 0x26, 0xAB, 0x8C, 0x3F, 0xC0, 0x3D, 0x21, 0x6B, 0x6B, 0x98, 0xDE,
  0x88, 0x27, 0x16, 0x73, 0x13, 0xDF, 0x6D, 0x4E, 0x7D, 0xCF, 0xE3, 0x11, 0xF0, 0x6E, 0x32, 0xE7,
  0xD6, 0x41, 0x39, 0x90, 0x55, 0x00, 0x8E, 0xD3, 0x33, 0xAB, 0x0E, 0x7D, 0xCA, 0xAC, 0x9A, 0x07,
  0x29, 0xB3, 0x84, 0x37, 0x11, 0xD1, 0x3D, 0x1D, 0xB7, 0xFA, 0xD1, 0x59, 0xAB, 0xD5, 0xAA, 0x23,
  0x18, 0x12, 0xEA, 0xA0, 0x48, 0x32, 0x3F, 0x9C, 0x15, 0x28, 0xF6, 0x15, 0x0A, 0x6F, 0x3D, 0x75,
  0xC7, 0x84, 0x66, 0x01, 0x6B, 0x71, 0x48, 0x1A, 0xCB, 0x24, 0xC0, 0x32, 0xA5, 0x34, 0x0E, 0xE2,
  0x94, 0xC3, 0x58, 0x54, 0x23, 0x2F, 0xF0, 0xB7, 0xA9, 0x48, 0xEA, 0xB5, 0x7C, 0x9D, 0xD1, 0x53,
  0x47, 0x61, 0x12, 0x67, 0x81, 0x03, 0xC3, 0xCA, 0xA0, 0x20, 0x76, 0x81, 0x1B, 0x5D, 0xF6, 0xDB,
  0x93, 0xB7, 0x6F, 0xB0, 0x46, 0x8E, 0xB7, 0x14, 0xAA, 0xA0, 0x5A, 0xA9, 0x90, 0x08, 0x84, 0x81,
  0xA5, 0x6E, 0xC8, 0x65, 0x17, 0xF0, 0x51, 0xC0, 0xF4, 0xB9, 0x91, 0xC7, 0x2E, 0xFD, 0x20, 0x00,
  0xEC, 0x0F, 0xDE, 0x1F, 0xBE, 0x7B, 0xFD, 0xEC, 0xC5, 0x21, 0x60, 0x76, 0x40, 0x9D, 0xC7, 0xF3,
  0x84, 0x8A, 0x43, 0x54, 0x02, 0xB5, 0xB5, 0x10, 0xD5, 0x35, 0x1D, 0x9E, 0x65, 0xCE, 0x8E, 0x74,
  0x74, 0x84, 0x4F, 0x90, 0xAF, 0x82, 0xD9, 0xA2, 0x08, 0xC3, 0x0D, 0xCA, 0x5E, 0xA9, 0xE1, 0x2A,
  0x02, 0x17, 0xBC, 0x82, 0xBE, 0x16, 0xC3, 0x9A, 0x6E, 0x00, 0x4D, 0xBF, 0xDD, 0xF1, 0x98, 0xCF,
  0xB2, 0xA1, 0xD5, 0xFA, 0x94, 0xC6, 0x91, 0x43, 0x96, 0x77, 0x4C, 0x49, 0xB8, 0x36, 0x36, 0x58,
  0xAC, 0xBD, 0x96, 0xA9, 0x55, 0x2B, 0x5B, 0x7B, 0x01, 0xEF, 0xDC, 0x34, 0x13, 0x24, 0x2E, 0xE3,
  0x8B, 0x6A, 0xCC, 0x4D, 0xB8, 0xAB, 0x50, 0x3E, 0x85, 0x67, 0xAB, 0xA4, 0xF0, 0x28, 0x5B, 0x6E,
  0x54, 0xF1, 0xF6, 0x44, 0xC2, 0xB2, 0x50, 0xBC, 0x55, 0x7B, 0xB6, 0xBA, 0xAA, 0x1C, 0x6E, 0xC1,
  0x59, 0x11, 0x56, 0x49, 0xD7, 0x95, 0xB2, 0x98, 0xC5, 0xCD, 0x6C, 0xEE, 0x37, 0xC3, 0x38, 0x8A,
  0x49, 0x6A, 0x1C, 0x76, 0xF2, 0xEA, 0x18, 0x1E, 0x9A, 0xEF, 0xF9, 0xD9, 0x3C, 0x70, 0x13, 0x87,
  0x1D, 0x73, 0xE0, 0x3D, 0x07, 0xD5, 0x11, 0x4C, 0xEC, 0xA6, 0x0E, 0xD3, 0x7D, 0x2B, 0x27, 0x30,
  0xA4, 0x70, 0x25, 0x15, 0x0A, 0x2E, 0x83, 0xA4, 0x08, 0x69, 0x8D, 0x82, 0xEB, 0xB4, 0xBE, 0x4F,
  0xB4, 0x42, 0xE4, 0xEB, 0x4F, 0x65, 0x4C, 0xFD, 0xB7, 0x8E, 0x2F, 0xE0, 0x93, 0x44, 0xBD, 0xE7,
  0x54, 0x67, 0xA6, 0xBD, 0x0B, 0x21, 0x66, 0xB6, 0x6C, 0x6E, 0x14, 0x5D, 0x84, 0xF5, 0xB5, 0x02,
  0xD6, 0x92, 0x05, 0x35, 0x6A, 0x61, 0x81, 0xEA, 0xF3, 0x94, 0xDE, 0x13, 0x72, 0x20, 0x58, 0x5F,
  0x68, 0x67, 0x8B, 0x3A, 0x70, 0xCF, 0xCF, 0x8E, 0x3C, 0x1D, 0x34, 0xFD, 0xF5, 0x95, 0xA4, 0x42,
  0xEB, 0x54, 0x24, 0x8D, 0xC1, 0x5B, 0x62, 0xB9, 0xDA, 0xCC, 0x78, 0x78, 0x27, 0x5D, 0x09, 0x6A,
  0xFD, 0x0E, 0xBA, 0xB2, 0x46, 0x4C, 0xEB, 0x62, 0x5E, 0x29, 0xA3, 0xC2, 0x07, 0x2A, 0x4A, 0xA7,
  0x11, 0xA7, 0x60, 0x54, 0x09, 0x7A, 0xC8, 0x74, 0x5D, 0x85, 0x12, 0x12, 0xE9, 0x29, 0xF9, 0xBB,
  0xFC, 0x52, 0x1E, 0x6F, 0x70, 0x4F, 0xA5, 0x9F, 0x16, 0xF4, 0x93, 0x69, 0xA5, 0x45, 0x6F, 0x45,
  0xBA, 0x68, 0xD1, 0x5B, 0xCA, 0x03, 0x2D, 0x7A, 0x99, 0xE7, 0x76, 0x8A, 0x3D, 0x8A, 0xF1, 0xD5,
  0x82, 0xDC, 0x73, 0x1D, 0x9D, 0xB4, 0xA7, 0xB6, 0x90, 0x54, 0x5C, 0xF4, 0xA8, 0xA5, 0x96, 0x4E,
  0x9E, 0x58, 0x39, 0x69, 0xFE, 0xC0, 0xD3, 0xC5, 0x04, 0x94, 0xFD, 0x3B, 0xD6, 0xC1, 0x9B, 0x78,
  0xCD, 0x35, 0x7C, 0x0B, 0x6E, 0x58, 0x95, 0x8B, 0xBA, 0x7F, 0x50, 0x23, 0x92, 0x0C, 0x13, 0x37,
  0x3A, 0x8A, 0x96, 0xE4, 0x3D, 0x0C, 0x43, 0x26, 0xBA, 0xDE, 0x37, 0x07, 0x75, 0x07, 0x5C, 0xEA,
  0x33, 0x1E, 0x0B, 0x63, 0xB9, 0x95, 0x99, 0xA7, 0x45, 0x59, 0xE7, 0x3A, 0x7A, 0x2F, 0xCC, 0x33,
  0x7D, 0x2D, 0xA1, 0xF1, 0x54, 0x72, 0x5D, 0x4A, 0xCB, 0xBE, 0xF7, 0xCD, 0x2F, 0xDD, 0x05, 0x9B,
  0x95, 0xB4, 0xFE, 0xA6, 0xDC, 0x4C, 0x21, 0x59, 0x5D, 0x96, 0xA8, 0x78, 0xAC, 0x27, 0xAA, 0xC8,
  0x4C, 0xFA, 0x1A, 0x52, 0x4D, 0xF7, 0x72, 0x7E, 0x88, 0xE7, 0x49, 0x5D, 0x6E, 0xA6, 0xD2, 0xF1,
  0x18, 0x28, 0xB7, 0x4E, 0xBF, 0x67, 0xE1, 0x2C, 0x84, 0x8E, 0x52, 0xAE, 0x9F, 0x1D, 0x6B, 0x11,
  0x57, 0x4D, 0xEF, 0x8C, 0xA6, 0x12, 0xB8, 0xD5, 0x67, 0x67, 0xF5, 0xB4, 0x80, 0xE8, 0xFB, 0x6B,
  0x49, 0x11, 0xCF, 0xD6, 0xA3, 0x44, 0x3C, 0x5B, 0x8B, 0x10, 0xF1, 0xEC, 0x5B, 0xD3, 0xE1, 0xFF,
  0xD0, 0x1F, 0x4A, 0xDD, 0x0B, 0xAE, 0x73, 0x36, 0xC0, 0xE5, 0x27, 0xF0, 0x7C, 0x57, 0xF7, 0x47,
  0x19, 0xFA, 0x75, 0xDC, 0x9F, 0x74, 0x9C, 0xF8, 0x33, 0x20, 0x46, 0xC0, 0x21, 0x2A, 0xC1, 0xB3,
  0xB4, 0x61, 0x34, 0x0F, 0x82, 0xBD, 0x07, 0x0F, 0x26, 0xF3, 0x88, 0x42, 0x61, 0x86, 0x97, 0x35,
  0xEC, 0xF8, 0xDC, 0x61, 0x19, 0xF8, 0xB1, 0x37, 0x2C, 0xE1, 0xD9, 0x3C, 0x89, 0xD8, 0x47, 0x71,
  0x30, 0x2B, 0x91, 0xC0, 0x3E, 0xEC, 0x57, 0x37, 0xF1, 0xF9, 0xD3, 0xC7, 0xF1, 0xF9, 0xE3, 0xC1,
  0xE3, 0x91, 0xEB, 0x3D, 0xBE, 0xB5, 0x0E, 0x7E, 0x75, 0x03, 0x63, 0x6E, 0xE5, 0x99, 0xED, 0x47,
  0x2A, 0xDC, 0xD0, 0x60, 0x49, 0xA4, 0x7D, 0xCF, 0xF1, 0xA8, 0x22, 0x02, 0x88, 0x98, 0x42, 0x5C,
  0x15, 0x0C, 0xBD, 0x78, 0x0C, 0xBA, 0x21, 0xCA, 0x5A, 0x67, 0x3C, 0x3B, 0x0C, 0x38, 0xFE, 0x7C,
  0x7E, 0x7D, 0xE4, 0x41, 0x4F, 0x3A, 0xF9, 0x47, 0x34, 0x2F, 0x86, 0x33, 0xBC, 0x49, 0x7A, 0x14,
  0x65, 0x36, 0x0F, 0x5A, 0xA4, 0x60, 0xBE, 0x7C, 0x01, 0x1B, 0xE7, 0x50, 0x91, 0xA1, 0x3F, 0xB1,
  0xFD, 0xF4, 0x8D, 0xFB, 0xC6, 0xBE, 0x68, 0x34, 0xA0, 0x2B, 0xD5, 0x64, 0x5D, 0x6C, 0x0C, 0xA9,
  0x76, 0x0A, 0xDF, 0x79, 0xC3, 0x61, 0x6E, 0x15, 0xBE, 0x7C, 0x61, 0xA2, 0x81, 0x0E, 0x2A, 0xB0,
  0xFF, 0xB1, 0x9B, 0x4D, 0x5B, 0xA1, 0x7B, 0x05, 0xEE, 0xBC, 0xF8, 0x09, 0x58, 0x76, 0x77, 0x9D,
  0x0B, 0x51, 0x99, 0xAB, 0x01, 0x68, 0x65, 0x97, 0x43, 0xA0, 0xE4, 0x7A, 0x01, 0xC4, 0x96, 0x09,
  0xA3, 0xD7, 0xA9, 0x00, 0x11, 0x49, 0xE3, 0x85, 0xB3, 0x76, 0x6B, 0x07, 0x1C, 0x2F, 0x1C, 0xD0,
  0xD7, 0x68, 0x2A, 0xB2, 0x0C, 0x2F, 0x5A, 0x59, 0x7C, 0x92, 0x25, 0x10, 0xE8, 0xD8, 0xF0, 0xE2,
  0x36, 0xA7, 0x3E, 0x04, 0x74, 0x01, 0x8A, 0xB1, 0xBC, 0x12, 0x63, 0x1B, 0x9B, 0x30, 0x05, 0xD9,
  0x7C, 0x3B, 0x83, 0xE8, 0x76, 0xC8, 0x7E, 0xFA, 0x19, 0xA1, 0x81, 0xB6, 0xB4, 0x91, 0xEE, 0xD3,
  0x61, 0x77, 0x6F, 0xBA, 0x3F, 0xEC, 0xF6, 0xF6, 0xA6, 0x1B, 0x1B, 0x0D, 0xDD, 0x8F, 0xAE, 0x9A,
  0xD9, 0x1F, 0x4B, 0x2E, 0xC7, 0xAF, 0x6E, 0xA6, 0xC4, 0x00, 0xD3, 0x5B, 0x2D, 0x79, 0x1F, 0x09,
  0xB7, 0x9F, 0x0C, 0x5D, 0xE8, 0xE4, 0xCA, 0xE0, 0x67, 0xAC, 0x3A, 0x3E, 0x74, 0xC7, 0x53, 0x5C,
  0xEA, 0xC1, 0x12, 0x2E, 0x68, 0x51, 0xEA, 0xE4, 0x87, 0xD3, 0xE3, 0xD7, 0x80, 0xA0, 0xC6, 0xE1,
  0x53, 0x0C, 0x04, 0xB0, 0x2C, 0x5C, 0x3E, 0xD6, 0xBB, 0xB4, 0x31, 0xE2, 0x9B, 0x67, 0x1C, 0xAB,
  0x92, 0x58, 0xBF, 0x29, 0x1E, 0x80, 0xBF, 0xF9, 0x2C, 0x65, 0xB0, 0x16, 0x37, 0x6A, 0xB4, 0xD8,
  0x0B, 0x91, 0x8E, 0xC6, 0xC6, 0x61, 0x17, 0x68, 0xCC, 0xAE, 0xE3, 0x39, 0xBB, 0x74, 0x61, 0x52,
  0x4D, 0x0A, 0x18, 0x57, 0x4B, 0x89, 0x10, 0xD8, 0x2A, 0xDC, 0xDF, 0x86, 0x7F, 0x36, 0x86, 0x7D,
  0x59, 0xD1, 0x23, 0x47, 0x84, 0xD0, 0xD9, 0x0E, 0xF7, 0x81, 0x15, 0xD9, 0x53, 0x66, 0x03, 0x57,
  0x6E, 0x84, 0x0D, 0x36, 0x80, 0x5F, 0xF8, 0x43, 0xDF, 0x62, 0x5B, 0x46, 0xB7, 0x90, 0xE8, 0x16,
  0x86, 0x65, 0xC2, 0xDD, 0xE6, 0xC4, 0x43, 0xB5, 0xE8, 0x68, 0x05, 0x79, 0x3F, 0xD2, 0x29, 0x2C,
  0x2A, 0x94, 0xF3, 0xF8, 0xC4, 0x9D, 0x07, 0x59, 0x8A, 0x75, 0xF3, 0x0B, 0x60, 0x19, 0x5B, 0xD8,
  0x10, 0x9C, 0x06, 0x00, 0xD1, 0x9D, 0xDA, 0x5B, 0x39, 0x08, 0x11, 0x36, 0xC6, 0xAC, 0x33, 0x84,
  0xB4, 0xBB, 0x31, 0xE6, 0xDD, 0xB1, 0x45, 0xB8, 0x2E, 0x19, 0x25, 0x99, 0xCA, 0x18, 0xB4, 0xBD,
  0x6A, 0x22, 0x41, 0x4B, 0x63, 0xC4, 0x66, 0x67, 0xF5, 0x90, 0x32, 0x6A, 0xCF, 0x10, 0x35, 0x53,
  0xCB, 0x65, 0xF1, 0xB1, 0x60, 0xC4, 0x13, 0x1F, 0x94, 0xF1, 0xB1, 0xEF, 0x45, 0x18, 0xDC, 0xD9,
  0xD3, 0x6E, 0x0F, 0xA2, 0x7A, 0x87, 0xB9, 0x30, 0x9E, 0xF8, 0x87, 0xE4, 0x0B, 0x20, 0x68, 0xCD,
  0x86, 0x3D, 0xE4, 0x55, 0x14, 0xE2, 0xB8, 0xD0, 0x7C, 0x19, 0xAA, 0x57, 0x5A, 0xD9, 0x4D, 0x1B,
  0xA4, 0x89, 0xE8, 0x77, 0x18, 0x82, 0xE6, 0x93, 0x6A, 0x5A, 0x28, 0x73, 0x46, 0x13, 0x21, 0x67,
  0xE2, 0x5F, 0x50, 0x96, 0x80, 0x73, 0x16, 0xFF, 0x38, 0x9B, 0xF1, 0xE4, 0x85, 0x9B, 0x72, 0x5B,
  0xC1, 0xC2, 0xB7, 0xA8, 0x67, 0x60, 0x19, 0x92, 0xAB, 0xA1, 0x71, 0x0A, 0x2D, 0xDD, 0x1E, 0xC8,
  0xBB, 0xD0, 0xA5, 0xB7, 0xA0, 0x5D, 0x52, 0xCE, 0xF2, 0xD7, 0x0F, 0xE5, 0xEB, 0x0D, 0xD4, 0x0C,
  0x92, 0x4F, 0xE5, 0xEC, 0xD3, 0xEF, 0xB7, 0x3B, 0x6C, 0x03, 0x90, 0x2F, 0x12, 0x45, 0xCA, 0xE6,
  0x69, 0x2C, 0xB4, 0x4F, 0x9C, 0xA4, 0x36, 0x34, 0xA5, 0x0E, 0xDE, 0x5A, 0x9B, 0xF8, 0x57, 0x39,
  0x41, 0x7A, 0x5B, 0x80, 0x33, 0xE9, 0xB7, 0x49, 0x10, 0x83, 0xEC, 0x61, 0xAF, 0xF6, 0xB6, 0x41,
  0x15, 0xC1, 0xC7, 0x29, 0xFB, 0x8E, 0x6D, 0x77, 0x54, 0xA3, 0x5A, 0x2A, 0x8C, 0x3E, 0x20, 0xCC,
  0x9E, 0x12, 0xCB, 0x80, 0x10, 0x8A, 0xED, 0x91, 0xB0, 0xBB, 0x3D, 0xD4, 0x1F, 0x30, 0xC3, 0x77,
  0x0C, 0xF0, 0xA6, 0x95, 0x74, 0x7B, 0xB0, 0x54, 0x10, 0x5C, 0xFC, 0x81, 0x6B, 0x59, 0xB2, 0xFB,
  0x02, 0xD3, 0x0D, 0xAB, 0xC4, 0x66, 0x52, 0xD7, 0x02, 0x80, 0x92, 0x22, 0xCA, 0xAF, 0x1B, 0xCE,
  0x53, 0xD0, 0x4A, 0xA4, 0x92, 0x84, 0x3E, 0xDA, 0x63, 0x69, 0xE4, 0xCE, 0xE8, 0x8C, 0x8C, 0xBB,
  0x09, 0x4F, 0x33, 0xAD, 0x7D, 0xF0, 0x35, 0xC0, 0xA4, 0xFB, 0xB5, 0xB2, 0x25, 0xC2, 0x3B, 0x72,
  0x9E, 0x22, 0x0A, 0x25, 0x9F, 0xEC, 0xB0, 0x8D, 0x1D, 0x1B, 0xDF, 0xE3, 0xBF, 0x79, 0x57, 0xA1,
  0x88, 0xE4, 0x80, 0x83, 0xE1, 0x36, 0xE9, 0xA3, 0x7E, 0x1F, 0xA8, 0x20, 0xDB, 0xF6, 0xD6, 0x58,
  0x5D, 0x51, 0x22, 0xE4, 0xE2, 0xC2, 0xB0, 0xB1, 0x16, 0x69, 0x4A, 0xB2, 0x81, 0xDB, 0x52, 0x64,
  0x83, 0x04, 0x9C, 0x25, 0x9E, 0x28, 0x67, 0xE7, 0x14, 0xC3, 0x5E, 0xD3, 0x0E, 0xE1, 0x79, 0xC2,
  0xE1, 0x62, 0x87, 0x40, 0x9C, 0x37, 0x10, 0x2B, 0x88, 0x9E, 0x05, 0xED, 0x66, 0x93, 0x2F, 0xD3,
  0x52, 0x79, 0xD6, 0x2F, 0x5F, 0x7E, 0xFA, 0xB9, 0x01, 0xF6, 0x72, 0x66, 0xDB, 0xA9, 0xE3, 0x37,
  0x86, 0x07, 0x1F, 0x1F, 0x94, 0x4E, 0x7E, 0xF6, 0x33, 0x0F, 0xB4, 0xAE, 0xBF, 0xD1, 0x05, 0xB5,
  0x9B, 0x79, 0xC5, 0xD6, 0xB4, 0x85, 0x51, 0x4B, 0xED, 0x0B, 0xF4, 0x03, 0x5E, 0xDD, 0x42, 0xE4,
  0x55, 0xF7, 0x12, 0xBC, 0x8C, 0xDA, 0x41, 0xA4, 0xD5, 0x16, 0xBC, 0x89, 0x67, 0xB5, 0x2F, 0x64,
  0x56, 0x00, 0x79, 0x19, 0x02, 0x7E, 0x6B, 0x60, 0xBD, 0x89, 0xAD, 0x72, 0x47, 0xE5, 0x98, 0xD6,
  0x1C, 0xEE, 0xD4, 0xD6, 0x2E, 0xC8, 0x5B, 0x55, 0xC5, 0xC3, 0xF1, 0xA2, 0x73, 0x29, 0xEB, 0x67,
  0x2D, 0x46, 0x55, 0x8B, 0x43, 0xEB, 0xD0, 0xF3, 0xB3, 0xD2, 0x41, 0x1E, 0x36, 0xD9, 0x88, 0xA2,
  0xEF, 0xDD, 0x82, 0xD3, 0xF9, 0x97, 0xFF, 0xF8, 0xE7, 0xDA, 0x53, 0xFF, 0x5A, 0xB8, 0x4C, 0xDC,
  0x13, 0xD3, 0xE0, 0x5F, 0x82, 0x3E, 0xC8, 0xB8, 0x59, 0xF8, 0x46, 0x0D, 0x6F, 0x23, 0x6E, 0xCC,
  0xF0, 0x3F, 0xFF, 0xF9, 0xEF, 0xFF, 0x52, 0x13, 0x88, 0x16, 0x8F, 0x8F, 0x15, 0x61, 0xE8, 0xF8,
  0xEA, 0x63, 0x43, 0x5B, 0xB9, 0x65, 0x1C, 0xF8, 0x02, 0x0F, 0x96, 0x4C, 0x0E, 0xA4, 0x93, 0xA6,
  0xC5, 0x0C, 0x28, 0x0E, 0xA2, 0x1A, 0x86, 0x78, 0x22, 0x20, 0x60, 0xBE, 0x22, 0xEF, 0xA1, 0x62,
  0x16, 0xEE, 0x03, 0xE8, 0x98, 0x87, 0xD4, 0xDA, 0x0A, 0x78, 0x74, 0x96, 0x4D, 0x95, 0xE7, 0x80,
  0x70, 0x0A, 0xDC, 0xFB, 0xB1, 0x50, 0x9A, 0x29, 0xEA, 0xCC, 0x2A, 0x4D, 0x32, 0x27, 0xF8, 0x26,
  0xCE, 0xCB, 0xB1, 0xE9, 0xC2, 0x44, 0x4D, 0xC9, 0xC0, 0x82, 0x1A, 0x00, 0x2C, 0xFA, 0xAC, 0x39,
  0x5F, 0x10, 0x15, 0x00, 0xA7, 0xA0, 0x94, 0x30, 0xDF, 0x08, 0x8A, 0x69, 0x9C, 0x70, 0x58, 0x10,
  0xEC, 0x8A, 0x3A, 0xB4, 0x17, 0xFF, 0x7E, 0x14, 0xEE, 0x8C, 0xD0, 0xF5, 0x4A, 0xF3, 0x57, 0x17,
  0x23, 0x56, 0x5C, 0x95, 0xBD, 0xEA, 0x12, 0xEB, 0xEA, 0x52, 0xE5, 0xCD, 0x95, 0x05, 0x2C, 0x6C,
  0x12, 0x42, 0x27, 0x46, 0x1F, 0x09, 0x39, 0x96, 0xA5, 0xA3, 0x72, 0x7D, 0xAB, 0xAE, 0x13, 0xE1,
  0x77, 0x1A, 0xAC, 0x03, 0xFB, 0xE8, 0x25, 0x53, 0x9C, 0x56, 0x57, 0x32, 0x5B, 0x9C, 0x9D, 0x6E,
  0x73, 0x30, 0x43, 0x3C, 0x21, 0xFA, 0x89, 0x20, 0xFA, 0x11, 0xA1, 0x8F, 0xD1, 0x2A, 0xB3, 0x7E,
  0xF0, 0xEA, 0xA5, 0xFC, 0x8A, 0xC2, 0xE3, 0xDB, 0x35, 0xEB, 0x1D, 0x74, 0x9D, 0x78, 0x89, 0x02,
  0x8B, 0xEA, 0x30, 0xD2, 0xF1, 0xEF, 0x2C, 0x99, 0x8D, 0x5D, 0xDA, 0xEB, 0xF7, 0x96, 0xA9, 0xD8,
  0x16, 0x57, 0x62, 0xAC, 0x31, 0x1B, 0x65, 0x9F, 0xDA, 0x8C, 0x8E, 0xB4, 0xD7, 0x99, 0x53, 0xEB,
  0x4C, 0xAA, 0xF5, 0xCD, 0x15, 0xE5, 0x57, 0x21, 0x21, 0xCF, 0xCD, 0xD7, 0x99, 0x5F, 0xA9, 0xDF,
  0xAF, 0x9C, 0x0F, 0x0F, 0xE3, 0xD7, 0x9B, 0x8E, 0x74, 0xFA, 0x7D, 0x8A, 0x5D, 0xF4, 0x5D, 0x19,
  0xEB, 0x0E, 0x85, 0x1A, 0x25, 0x85, 0x8C, 0x8F, 0xEB, 0x95, 0x7B, 0x48, 0x49, 0x59, 0x7D, 0x27,
  0x77, 0xC5, 0xAD, 0xDE, 0x15, 0xFA, 0x5B, 0x28, 0xF9, 0x95, 0xC9, 0xBB, 0x15, 0x4A, 0x5B, 0xE8,
  0x69, 0xD2, 0xA8, 0xA8, 0x6D, 0x1B, 0x5A, 0x0D, 0x2D, 0x73, 0xD9, 0xB1, 0x4E, 0x1E, 0x3C, 0x5F,
  0xB0, 0x8F, 0x2F, 0x44, 0xD2, 0x46, 0x2B, 0x6B, 0xF1, 0x95, 0xA9, 0x0F, 0xF8, 0x2D, 0x2A, 0xD4,
  0xD7, 0x56, 0x73, 0xB9, 0xEF, 0x8F, 0x45, 0xF5, 0x4B, 0x01, 0x41, 0x87, 0x75, 0xE0, 0xF8, 0xB3,
  0x12, 0x18, 0x0D, 0xC7, 0x9F, 0xAD, 0x33, 0x5E, 0x15, 0xE6, 0xD7, 0xE3, 0x82, 0x6F, 0x35, 0x94,
  0x65, 0x60, 0xB0, 0x64, 0xBF, 0x18, 0x1D, 0xE6, 0x00, 0x3E, 0x80, 0x03, 0xE7, 0xA3, 0xE3, 0x41,
  0x79, 0x20, 0xAC, 0x51, 0x70, 0xAC, 0x93, 0x6B, 0x08, 0x66, 0x3C, 0x0B, 0x03, 0x5B, 0x6A, 0x9D,
  0xB8, 0x10, 0x12, 0x38, 0xE0, 0x93, 0x64, 0x4C, 0xBD, 0x5A, 0x8A, 0x36, 0x56, 0xFE, 0xD7, 0xCD,
  0x07, 0xED, 0x1F, 0xC6, 0xFA, 0x9E, 0x43, 0x61, 0x4A, 0x7D, 0xFD, 0xA1, 0x32, 0x6B, 0x5E, 0x53,
  0x2F, 0xE6, 0xD5, 0xE6, 0x38, 0xFB, 0x9C, 0x3B, 0x82, 0xD9, 0xE7, 0x0F, 0x31, 0xDD, 0x28, 0xF8,
  0x90, 0xF2, 0xF1, 0x43, 0xCA, 0x71, 0xA1, 0x43, 0x2C, 0x5D, 0xDA, 0x9A, 0x3E, 0x38, 0xCB, 0x4A,
  0xEA, 0x7F, 0xAE, 0x10, 0x3E, 0xFB, 0x6C, 0x20, 0xE0, 0x8E, 0xF3, 0xBD, 0xC0, 0xBB, 0xF4, 0x17,
  0xFC, 0x83, 0x32, 0xD5, 0x1F, 0x80, 0xA4, 0xB0, 0x33, 0x9D, 0xE5, 0x11, 0x66, 0x5E, 0xE0, 0x5E,
  0x9E, 0x07, 0x41, 0x63, 0x7E, 0xE1, 0xFD, 0x3C, 0x8A, 0x60, 0x05, 0xB9, 0x0B, 0x70, 0xF4, 0x12,
  0xF0, 0xDE, 0x80, 0xD7, 0xB4, 0x00, 0xDC, 0x11, 0x08, 0x34, 0x5C, 0xFD, 0xDE, 0x13, 0x85, 0x72,
  0x2B, 0xA3, 0x6E, 0xAC, 0x88, 0xAF, 0x67, 0x2A, 0xF1, 0xF2, 0x43, 0x3A, 0x0F, 0x31, 0x73, 0x69,
  0xB2, 0x57, 0xAD, 0x3F, 0xBF, 0x57, 0x79, 0x21, 0xDD, 0x2C, 0x12, 0x6A, 0x8C, 0xC4, 0x12, 0x71,
  0x97, 0xE1, 0x28, 0x7A, 0x15, 0xA0, 0x25, 0x1E, 0xD2, 0xB6, 0xEE, 0x3D, 0x70, 0x53, 0xE0, 0x24,
  0x66, 0x48, 0xBD, 0xB8, 0x00, 0xA1, 0xC4, 0x5E, 0x23, 0x2F, 0xCE, 0x67, 0x1B, 0x86, 0x1B, 0x02,
  0x6F, 0x4B, 0x30, 0xCD, 0xB7, 0xE5, 0xE9, 0x90, 0xBD, 0xB0, 0x3D, 0x4B, 0xAE, 0xCD, 0x44, 0x4E,
  0x32, 0x74, 0x2F, 0x5D, 0x3F, 0x63, 0x13, 0x9E, 0x8D, 0xA7, 0xB6, 0xD5, 0x76, 0x67, 0x7E, 0x9B,
  0x08, 0x60, 0x39, 0x37, 0x63, 0x17, 0x96, 0x32, 0xB0, 0xA2, 0xB8, 0x09, 0xBA, 0x3D, 0xE1, 0xD6,
  0xAD, 0x4C, 0xEC, 0x88, 0xFC, 0xA9, 0x18, 0x97, 0x50, 0x91, 0x84, 0xDD, 0x50, 0x3E, 0x92, 0xD0,
  0x59, 0x22, 0x80, 0x9E, 0xF8, 0x11, 0x96, 0x27, 0xCA, 0x18, 0x7A, 0xC1, 0xFA, 0xD1, 0x9D, 0xC2,
  0xEF, 0x39, 0xE5, 0x09, 0x53, 0x8E, 0x7B, 0x11, 0x1D, 0xE3, 0x05, 0x2E, 0x3B, 0x4C, 0xCF, 0x1C,
  0x26, 0xCB, 0x88, 0x68, 0x09, 0x0E, 0x04, 0xFF, 0x87, 0x49, 0x12, 0x27, 0x62, 0xBC, 0xE1, 0xC5,
  0x7A, 0x4B, 0x3C, 0x58, 0x59, 0x1E, 0x65, 0xF8, 0xB0, 0xE1, 0xF2, 0xDE, 0x58, 0x4F, 0x60, 0x7A,
  0xBC, 0xB3, 0xE5, 0xDD, 0xA9, 0xEA, 0x49, 0x65, 0x17, 0xC2, 0x06, 0x0B, 0x4B, 0x2C, 0x05, 0xCB,
  0x20, 0x0E, 0xB2, 0x64, 0x97, 0x74, 0xD6, 0x00, 0x98, 0x2D, 0xB2, 0x44, 0x2D, 0x79, 0xE9, 0x0F,
  0x39, 0x4F, 0x2C, 0x14, 0xA3, 0x1F, 0xF3, 0xEB, 0x46, 0x14, 0xD3, 0xE3, 0x95, 0x40, 0x4B, 0xCF,
  0x20, 0x3F, 0x2B, 0x27, 0x21, 0x90, 0x0D, 0x83, 0xF1, 0x92, 0x34, 0x38, 0x3E, 0xFF, 0xD4, 0x10,
  0x8D, 0x36, 0x4A, 0x34, 0x2C, 0xFD, 0xE5, 0x1B, 0xE0, 0x2E, 0xF6, 0xEB, 0x5F, 0xB3, 0x87, 0x5E,
  0x0B, 0xED, 0x69, 0x83, 0x79, 0xAD, 0x74, 0x1A, 0x5F, 0x0A, 0xC2, 0x17, 0xD3, 0xA8, 0x94, 0x6E,
  0xCF, 0x77, 0x05, 0xCC, 0x9D, 0x7B, 0x7D, 0x9C, 0xDE, 0x83, 0xF8, 0x68, 0xC8, 0x3C, 0x93, 0x4D,
  0x61, 0xB7, 0x31, 0x3F, 0x1B, 0xCF, 0x33, 0xDB, 0x06, 0x9F, 0xF9, 0x86, 0xF8, 0x93, 0x50, 0xD3,
  0x48, 0xD1, 0xE4, 0x36, 0xDE, 0xD3, 0x03, 0xAF, 0x1B, 0xB9, 0x14, 0x76, 0xFD, 0x96, 0xDD, 0x3A,
  0x4C, 0xA2, 0xF1, 0xE5, 0x4B, 0x47, 0x48, 0x59, 0x49, 0x94, 0xF2, 0xDB, 0x44, 0x3C, 0x20, 0x54,
  0x31, 0x11, 0xF9, 0x3C, 0x8B, 0xF0, 0x51, 0xE2, 0x02, 0xBF, 0x30, 0x89, 0xAC, 0xBE, 0xF9, 0x85,
  0x8A, 0xCD, 0x10, 0x13, 0x26, 0x59, 0x5C, 0x89, 0xA4, 0xB8, 0x29, 0xA8, 0xB9, 0xBA, 0x1E, 0x80,
  0x60, 0x6B, 0xC1, 0xD4, 0x25, 0x84, 0x8C, 0x0B, 0x57, 0xF7, 0xC0, 0xA8, 0x20, 0x17, 0x56, 0xA1,
  0xE4, 0xCD, 0x72, 0x98, 0x90, 0x0D, 0x21, 0x13, 0xA4, 0xA5, 0xCA, 0x72, 0x8E, 0xCA, 0xB4, 0x22,
  0xE9, 0x30, 0x45, 0x5B, 0x1A, 0x15, 0x90, 0xF7, 0x90, 0x67, 0xD3, 0xD8, 0x1B, 0x58, 0xEF, 0xDE,
  0x9E, 0x9C, 0x6A, 0x61, 0x47, 0xD5, 0x15, 0x9F, 0xC3, 0xE8, 0xA4, 0x15, 0x9F, 0xCB, 0xAF, 0xA6,
  0x28, 0xD0, 0x0A, 0xF8, 0x27, 0x0D, 0xBC, 0xA8, 0x0E, 0x68, 0x45, 0x58, 0x5E, 0x12, 0x4F, 0xD8,
  0xA7, 0x16, 0x42, 0x19, 0x0E, 0x19, 0x38, 0x5E, 0x31, 0xA6, 0xA6, 0xC1, 0xC0, 0x11, 0xDC, 0x4F,
  0x1A, 0xAE, 0xB1, 0xBF, 0x78, 0x95, 0x13, 0x02, 0x7B, 0xD0, 0x3A, 0xEC, 0xFB, 0xB6, 0xBA, 0x08,
  0x0B, 0xC0, 0xE2, 0xF3, 0x86, 0x9A, 0xBA, 0x96, 0x1E, 0x60, 0x1A, 0x25, 0x15, 0x72, 0x62, 0x88,
  0xEE, 0xE5, 0xBD, 0x54, 0x0B, 0x28, 0x72, 0xF6, 0x56, 0x5F, 0x7D, 0xF3, 0xAE, 0x90, 0xFF, 0x5B,
  0x30, 0x1B, 0x4C, 0xE1, 0x07, 0xE6, 0x94, 0xB8, 0x0B, 0x77, 0x9C, 0xB1, 0xDB, 0xEB, 0xE8, 0x29,
  0x1F, 0x14, 0x68, 0xF0, 0xE0, 0x5E, 0xF3, 0x2E, 0x60, 0x5C, 0x09, 0xF6, 0x03, 0x88, 0xCE, 0x83,
  0x65, 0x58, 0x94, 0xB5, 0xF6, 0x12, 0x1E, 0x57, 0xAA, 0xBB, 0xCA, 0xE5, 0xC6, 0x85, 0xC0, 0x7B,
  0x8A, 0xDE, 0x83, 0x9C, 0x80, 0x65, 0x7E, 0xF5, 0x34, 0xF0, 0x7A, 0x96, 0xBD, 0xDB, 0x0A, 0x6A,
  0xB6, 0xE9, 0xB6, 0xE0, 0x86, 0x1B, 0x35, 0xE1, 0xF5, 0x6B, 0x59, 0xA9, 0x00, 0x65, 0xA5, 0xA9,
  0xD1, 0x39, 0x5B, 0xDA, 0x99, 0xAA, 0xFB, 0x8C, 0xDE, 0x93, 0xA5, 0xBD, 0xA9, 0x7C, 0x71, 0x3D,
  0xC3, 0x26, 0xEB, 0xE4, 0xD4, 0x0E, 0x80, 0xBB, 0x90, 0xB5, 0x54, 0x89, 0x97, 0x6C, 0x9B, 0x34,
  0xD8, 0xA4, 0xDC, 0x56, 0xB6, 0x67, 0xF9, 0x9B, 0xA5, 0xE6, 0x43, 0x01, 0x94, 0x9F, 0x37, 0x6C,
  0x41, 0xB0, 0x24, 0x4E, 0xA2, 0x40, 0x57, 0x10, 0xC7, 0x90, 0xBE, 0xCF, 0xF5, 0xC4, 0xC3, 0x49,
  0x0B, 0xCB, 0x2F, 0x53, 0x34, 0x94, 0xEA, 0xB7, 0x4A, 0x20, 0x19, 0x06, 0x23, 0xD7, 0x3A, 0xD8,
  0x63, 0x28, 0x3B, 0xFE, 0xD4, 0xF9, 0xB9, 0xF8, 0x12, 0xF5, 0x5D, 0xC4, 0x2F, 0x19, 0x92, 0xE7,
  0x3D, 0x77, 0xB5, 0x57, 0x42, 0x9E, 0x08, 0xE0, 0x82, 0x45, 0xAF, 0xE8, 0x36, 0x93, 0xCD, 0x29,
  0x10, 0x23, 0xCF, 0x00, 0x27, 0x2D, 0x60, 0x89, 0x79, 0x90, 0xD1, 0x41, 0x02, 0xC8, 0x50, 0x3E,
  0x3E, 0x01, 0x88, 0xCF, 0x52, 0xDC, 0x28, 0x1B, 0xA7, 0x57, 0xF2, 0xAB, 0x45, 0xA2, 0x68, 0x38,
  0xA9, 0x4C, 0xEF, 0xE6, 0xAE, 0xAC, 0x52, 0x31, 0x95, 0xCB, 0x2C, 0x63, 0x6E, 0x18, 0x0B, 0xD3,
  0x83, 0xF6, 0x38, 0xA2, 0x4D, 0x17, 0x8E, 0x94, 0xF4, 0x0F, 0x0C, 0x5C, 0xD6, 0xE7, 0x96, 0x87,
  0xA1, 0x89, 0xCB, 0x52, 0x07, 0xE7, 0xAE, 0x6E, 0x89, 0xC8, 0x53, 0x59, 0x75, 0x36, 0xBC, 0x74,
  0xB9, 0x63, 0x5D, 0x6D, 0xB2, 0xD0, 0xDB, 0xAD, 0xB5, 0x82, 0x2A, 0x68, 0x68, 0x8B, 0xD9, 0x2C,
  0xB9, 0x9D, 0xB8, 0x68, 0x34, 0x7A, 0xA6, 0xC5, 0x91, 0xD4, 0xB4, 0x64, 0xF9, 0xB4, 0xD0, 0xC3,
  0x14, 0x89, 0x48, 0xF3, 0x87, 0x64, 0xB1, 0x1B, 0x25, 0x4B, 0x60, 0x72, 0xEF, 0xAD, 0x81, 0x4E,
  0x76, 0x95, 0x19, 0x96, 0x53, 0x0C, 0xDD, 0x33, 0xDE, 0x83, 0xF7, 0x37, 0x92, 0x7C, 0xFC, 0x1C,
  0x7E, 0xDA, 0x3F, 0xC1, 0x80, 0x9F, 0x1D, 0x76, 0x83, 0x26, 0x75, 0x60, 0x55, 0x0A, 0x93, 0x6F,
  0x0B, 0x83, 0xE7, 0x49, 0x00, 0x63, 0x7F, 0x7C, 0xFF, 0xBA, 0x25, 0xF2, 0x9A, 0x6F, 0x47, 0x9F,
  0x40, 0x67, 0xC2, 0xB3, 0x8D, 0x60, 0x0B, 0x5D, 0x5D, 0xE8, 0xA8, 0xF9, 0x40, 0xF4, 0x96, 0xAC,
  0x60, 0x5B, 0xAE, 0x55, 0xE8, 0x4A, 0xA7, 0xC4, 0x88, 0xD0, 0x4B, 0xFC, 0x98, 0x00, 0x1E, 0xAF,
  0x1D, 0x9D, 0xBC, 0x55, 0x47, 0xEF, 0x20, 0x17, 0xA2, 0xBE, 0xB5, 0xFD, 0xD3, 0xA0, 0xF5, 0x73,
  0xFB, 0xCC, 0x81, 0x90, 0x49, 0x7D, 0xC8, 0xA0, 0x85, 0x37, 0xB4, 0x61, 0x2C, 0xA0, 0xA5, 0x5A,
  0x54, 0xF1, 0x39, 0x9E, 0x28, 0x8E, 0xB8, 0xF7, 0x89, 0x67, 0x4D, 0xB5, 0x15, 0x4D, 0x6B, 0x23,
  0x4B, 0x37, 0x44, 0x05, 0xB6, 0x25, 0x3F, 0xF8, 0xA6, 0x10, 0xC4, 0x7B, 0x17, 0x2D, 0x3C, 0xDB,
  0x89, 0xBC, 0x17, 0x53, 0x3F, 0xF0, 0x6C, 0x57, 0xCF, 0x41, 0xE9, 0x18, 0x5B, 0x3F, 0x26, 0x3C,
  0x8C, 0x2F, 0xB8, 0x7A, 0x2E, 0xB9, 0x9A, 0x48, 0x99, 0x84, 0x5F, 0xC4, 0xE7, 0x06, 0x65, 0x00,
  0xB9, 0x06, 0x7D, 0xF5, 0x6F, 0x5D, 0x63, 0x38, 0x5C, 0x6A, 0x0A, 0x8B, 0x45, 0xBF, 0x5F, 0xCB,
  0xBC, 0xEB, 0x5A, 0x0D, 0xCD, 0x3D, 0x78, 0x63, 0x05, 0xCC, 0x6A, 0x1E, 0xFF, 0x67, 0xBA, 0x8A,
  0x04, 0x83, 0xDE, 0xC4, 0x0F, 0x6D, 0x8A, 0x9E, 0xAD, 0x9C, 0xDF, 0x89, 0xB6, 0x2A, 0x6B, 0x6F,
  0x32, 0x7C, 0x5E, 0x9C, 0xCE, 0x40, 0x92, 0xC7, 0xD3, 0x18, 0x34, 0x0F, 0xF0, 0x0D, 0x15, 0xDA,
  0x4F, 0xFC, 0x24, 0xCD, 0x94, 0x13, 0x0A, 0xDA, 0x48, 0xB2, 0xBB, 0x72, 0xDB, 0x0C, 0x28, 0xC2,
  0x90, 0x6A, 0xA7, 0xD5, 0xF4, 0xD0, 0xD6, 0x12, 0x50, 0x41, 0x50, 0x18, 0x59, 0x34, 0xFC, 0x0E,
  0xAD, 0xF5, 0x76, 0x0D, 0xB9, 0x95, 0x15, 0xD7, 0xF7, 0x96, 0x5B, 0xF4, 0x86, 0x3F, 0x0D, 0xD5,
  0x69, 0xB3, 0xD4, 0xC9, 0x35, 0xEE, 0x6F, 0x41, 0x23, 0xE7, 0xCB, 0x8B, 0xD0, 0xDF, 0x45, 0xA3,
  0xA9, 0x9D, 0xE2, 0x71, 0x3C, 0x47, 0x05, 0x8A, 0x7E, 0x71, 0x34, 0x0F, 0x47, 0x78, 0x48, 0xF4,
  0x54, 0x37, 0x0F, 0x58, 0x3E, 0x53, 0x65, 0x11, 0xE0, 0xC7, 0x58, 0x1B, 0x76, 0xF4, 0x70, 0x48,
  0xE8, 0x3C, 0x05, 0xD8, 0xB0, 0x1E, 0x45, 0x29, 0xAB, 0xB1, 0x61, 0xD1, 0x31, 0x89, 0x9D, 0x36,
  0xCA, 0x94, 0xAE, 0xF5, 0x4B, 0x4B, 0xC2, 0x91, 0xDB, 0x2D, 0x87, 0x6D, 0xF7, 0x95, 0x34, 0x54,
  0x5C, 0xD3, 0x5A, 0xB2, 0xE6, 0x9C, 0x70, 0x1F, 0x11, 0x32, 0x0A, 0xB2, 0x72, 0x41, 0x51, 0x39,
  0x50, 0x1C, 0x9A, 0x6F, 0x0A, 0x00, 0xA1, 0xBC, 0xEE, 0x6B, 0x1F, 0xD8, 0xCF, 0xF5, 0x40, 0x0E,
  0xC4, 0xD7, 0xA0, 0x85, 0x18, 0x54, 0x22, 0xCB, 0x42, 0x77, 0xA9, 0x1A, 0xF2, 0x11, 0x18, 0x50,
  0xF6, 0x7A, 0x22, 0x92, 0x2C, 0x7B, 0xB4, 0x80, 0x04, 0x66, 0x4C, 0x1D, 0x76, 0x67, 0x6F, 0x36,
  0x77, 0xE2, 0xDC, 0xE8, 0x30, 0x30, 0xD5, 0x6C, 0x59, 0x84, 0x45, 0x65, 0x96, 0xE1, 0x23, 0xF2,
  0x70, 0xB6, 0x62, 0x84, 0xA8, 0xC4, 0xCA, 0x87, 0x24, 0xF3, 0xE8, 0x87, 0x15, 0x43, 0x44, 0x25,
  0x56, 0x61, 0xC8, 0xF1, 0xEA, 0x21, 0xC7, 0x05, 0x77, 0xD4, 0x8D, 0xC8, 0x81, 0xC6, 0xF5, 0x68,
  0xCD, 0x42, 0x8F, 0xD2, 0x7F, 0x22, 0x3F, 0xA0, 0xA2, 0x5F, 0xF2, 0x55, 0x21, 0x71, 0xC4, 0xE2,
  0x72, 0xC5, 0x44, 0xCF, 0x6B, 0x8C, 0xC7, 0x25, 0x62, 0x2C, 0x2A, 0x56, 0xAA, 0xC7, 0x8B, 0xE7,
  0xF5, 0xC6, 0x1F, 0x8B, 0xF1, 0xC7, 0xA5, 0xF1, 0xC7, 0x4B, 0xC7, 0x6B, 0x00, 0xBF, 0x28, 0xFB,
  0x07, 0xE6, 0xE2, 0x84, 0xBB, 0xC9, 0x78, 0xFA, 0xCE, 0x4D, 0xDC, 0x30, 0x15, 0x72, 0xF4, 0x4B,
  0xDA, 0x02, 0xB6, 0xB3, 0x2D, 0xE4, 0x16, 0x90, 0x02, 0xFC, 0xA3, 0x38, 0x04, 0x28, 0xA4, 0xBD,
  0x59, 0xD5, 0x0D, 0xDA, 0x48, 0x36, 0x23, 0xED, 0x92, 0x03, 0x1D, 0x2A, 0xBD, 0xB0, 0x11, 0x45,
  0x0A, 0xFE, 0xA8, 0x7E, 0xB8, 0x5E, 0xD9, 0x0F, 0xB5, 0x09, 0xA2, 0x6F, 0x3C, 0xD2, 0x6B, 0xF6,
  0x70, 0x48, 0x75, 0x47, 0xB8, 0x1C, 0x5A, 0xB5, 0x7C, 0x6E, 0x34, 0xD8, 0x8D, 0x06, 0x8D, 0x1D,
  0x01, 0x34, 0xFE, 0x01, 0x09, 0x30, 0x5A, 0x8F, 0x45, 0xEB, 0xB1, 0xFA, 0x2A, 0x56, 0xBB, 0xCD,
  0x9E, 0xCF, 0xC1, 0xD6, 0x82, 0xCA, 0x0F, 0xC1, 0x23, 0xF6, 0xE9, 0xE6, 0x9D, 0xFC, 0xC8, 0x52,
  0xC8, 0xD3, 0xD4, 0x05, 0xBF, 0xDE, 0xE3, 0x58, 0x64, 0x39, 0xC2, 0x34, 0x2D, 0xDE, 0x01, 0x13,
  0x5F, 0x55, 0xCD, 0x8B, 0xCC, 0x70, 0x44, 0x5E, 0x62, 0x46, 0x4F, 0xA2, 0x34, 0xCC, 0xC8, 0x65,
  0xB0, 0x36, 0xE3, 0x51, 0x3A, 0xC7, 0x3D, 0xC1, 0x1E, 0xE7, 0x68, 0x26, 0x1A, 0xE5, 0xEE, 0xCF,
  0xE9, 0x40, 0x05, 0xF6, 0x85, 0x6D, 0x14, 0x28, 0x5C, 0x20, 0x9E, 0x39, 0x00, 0xE5, 0x44, 0x74,
  0x27, 0xF6, 0xDB, 0x60, 0xD6, 0x9F, 0xFF, 0xF4, 0xCA, 0xAA, 0xDB, 0x98, 0xC2, 0x30, 0x10, 0x48,
  0x31, 0x0A, 0x39, 0x1E, 0x06, 0xE9, 0x2A, 0x7F, 0xEB, 0xDB, 0x6C, 0x43, 0x01, 0x45, 0xD0, 0x54,
  0x89, 0x98, 0x8D, 0x46, 0xE1, 0x74, 0xD3, 0x44, 0x3D, 0x1F, 0xD3, 0x73, 0x28, 0x72, 0x8C, 0xE5,
  0x54, 0x90, 0x00, 0x23, 0xCE, 0x90, 0xFE, 0x09, 0x7A, 0x2C, 0xCB, 0x05, 0xC1, 0x36, 0xD2, 0x47,
  0xBC, 0x44, 0xEA, 0x8C, 0xA5, 0x31, 0xED, 0x94, 0xD8, 0xC6, 0x84, 0x07, 0x3E, 0x28, 0xAF, 0x6B,
  0x99, 0xC4, 0x4D, 0xD9, 0x88, 0x4F, 0x30, 0xFF, 0x82, 0x37, 0x46, 0x2F, 0xE3, 0xE4, 0x9C, 0xD1,
  0x79, 0x62, 0xDA, 0x32, 0x6C, 0x08, 0xCA, 0xC1, 0xBB, 0x24, 0x0E, 0x7D, 0x88, 0x42, 0xC0, 0x72,
  0x1F, 0x98, 0x3A, 0x37, 0x71, 0xD8, 0x4E, 0x47, 0x56, 0xDB, 0x2D, 0xB7, 0xEE, 0xE3, 0xD0, 0x93,
  0x87, 0x64, 0x4F, 0x71, 0xBD, 0xC0, 0x85, 0x79, 0x31, 0x67, 0xD9, 0xD2, 0xFF, 0xFF, 0xCA, 0x4A,
  0xD1, 0x31, 0x1B, 0x6E, 0x9D, 0xB8, 0xBD, 0xFF, 0x37, 0xC9, 0x4D, 0xE9, 0x39, 0xFF, 0xC6, 0xB9,
  0xA9, 0x75, 0xE6, 0xFD, 0xDB, 0xE7, 0xA6, 0x0A, 0x69, 0x1C, 0xBA, 0x8B, 0x7F, 0x43, 0x29, 0xDC,
  0x52, 0x55, 0xF0, 0xD2, 0x63, 0x22, 0x79, 0x1B, 0xCE, 0x28, 0x7F, 0x5C, 0x7E, 0xAC, 0xA4, 0xEF,
  0xB1, 0x95, 0x0F, 0x96, 0xAC, 0xCA, 0xBD, 0xB6, 0x15, 0xA7, 0xAF, 0xF2, 0x36, 0x99, 0x31, 0x33,
  0x5D, 0x10, 0x5B, 0x3E, 0x4A, 0xD6, 0x7C, 0xDF, 0xA1, 0x60, 0x55, 0x15, 0x79, 0x1B, 0x43, 0x76,
  0x57, 0x0C, 0x31, 0x6E, 0x6F, 0x99, 0x13, 0xAD, 0x24, 0x0C, 0xF4, 0x2E, 0x9D, 0x31, 0x14, 0xB7,
  0x88, 0x0E, 0xF5, 0x7D, 0xB3, 0x56, 0x1E, 0x9D, 0xD8, 0x45, 0x85, 0x6E, 0xC0, 0x0E, 0x9E, 0x7D,
  0x85, 0x8A, 0xE7, 0x0D, 0xF9, 0xCE, 0xF6, 0x55, 0x0B, 0xC6, 0x92, 0x3C, 0xCB, 0x06, 0x78, 0xD4,
  0x09, 0x0C, 0x84, 0x04, 0x32, 0xEC, 0x06, 0x3C, 0x01, 0x23, 0x87, 0xE4, 0xA7, 0xCF, 0x75, 0x4C,
  0xF0, 0x80, 0xDF, 0x2A, 0x87, 0x2D, 0x35, 0x2C, 0x72, 0x27, 0x1E, 0x91, 0x0A, 0x4C, 0x96, 0xF3,
  0xDF, 0x83, 0x57, 0x0E, 0x5F, 0x1E, 0x9D, 0x7E, 0x1D, 0xB3, 0xE0, 0x7A, 0xA9, 0xF0, 0xE5, 0x2E,
  0xEC, 0x62, 0xA0, 0x8E, 0xC3, 0x95, 0x6F, 0x72, 0x07, 0xDE, 0x31, 0x87, 0x53, 0x09, 0x4C, 0xE3,
  0xEE, 0x9C, 0x44, 0x83, 0x8D, 0x5A, 0xC0, 0x2E, 0x65, 0x8B, 0x3A, 0x96, 0xCA, 0x2A, 0xD2, 0x7B,
  0x55, 0x67, 0x2D, 0x8E, 0xB9, 0xD1, 0xE2, 0xCA, 0x66, 0x2A, 0x71, 0x96, 0x87, 0xDF, 0x37, 0xAA,
  0x14, 0xBD, 0x5C, 0x89, 0xAB, 0x18, 0xC4, 0x84, 0x04, 0xE6, 0x46, 0x94, 0x62, 0x5B, 0x79, 0x09,
  0xFB, 0xF2, 0x71, 0x34, 0x95, 0x18, 0x16, 0x4B, 0x5F, 0xFC, 0xF6, 0xC1, 0x57, 0xC8, 0x40, 0x7E,
  0xAF, 0xE5, 0x66, 0x15, 0x8C, 0x3C, 0xF9, 0x57, 0xC9, 0x3B, 0x14, 0x2F, 0xD7, 0x18, 0xD9, 0x3E,
  0x60, 0x86, 0x65, 0xBE, 0x7E, 0x89, 0x87, 0x8A, 0x3E, 0xFF, 0xB2, 0x81, 0x45, 0x26, 0xAA, 0xB8,
  0xFB, 0xEB, 0x72, 0x4F, 0x3E, 0x50, 0xED, 0xFD, 0xF0, 0x2E, 0x8C, 0x63, 0xB8, 0xE9, 0x29, 0x6C,
  0x0B, 0xC6, 0x19, 0xF5, 0x65, 0xE9, 0xC5, 0x7C, 0xD2, 0xCA, 0xA2, 0x7F, 0x67, 0x8D, 0xFE, 0x46,
  0x09, 0xF1, 0x3A, 0xDD, 0xCD, 0xA2, 0x61, 0xE8, 0x6E, 0x84, 0x57, 0xFC, 0xAB, 0x30, 0x2F, 0x5E,
  0x08, 0x70, 0x56, 0x77, 0xBF, 0x0B, 0xDE, 0xC5, 0x7B, 0x00, 0x02, 0x6D, 0x79, 0x9E, 0x0D, 0x60,
  0x86, 0x22, 0x11, 0x81, 0x8E, 0x2E, 0xCF, 0x1F, 0x0D, 0x85, 0x1B, 0x89, 0x0A, 0x1B, 0xAA, 0xD6,
  0x11, 0x77, 0xD3, 0x80, 0x57, 0x8B, 0x8A, 0xD7, 0x04, 0x86, 0x40, 0xF2, 0xD1, 0xE2, 0x72, 0x22,
  0x7E, 0x73, 0x82, 0xAE, 0xE6, 0x8D, 0xDD, 0x08, 0x75, 0xF7, 0x88, 0xEB, 0x6F, 0x53, 0x54, 0x34,
  0xB8, 0x24, 0x27, 0x29, 0xE6, 0xA5, 0x7C, 0x54, 0x50, 0xDD, 0x32, 0xEC, 0xA3, 0x85, 0xA1, 0x93,
  0x29, 0xB2, 0xA8, 0xA5, 0x34, 0x94, 0xEB, 0x79, 0x46, 0x4C, 0x89, 0xB9, 0xA7, 0xB7, 0x23, 0xF4,
  0x36, 0x6F, 0x48, 0xC2, 0x28, 0xA2, 0x13, 0xF1, 0x9A, 0xA3, 0x18, 0xD9, 0x61, 0x8A, 0x4B, 0x06,
  0xAA, 0x16, 0x47, 0x28, 0x0E, 0xB9, 0x07, 0xAA, 0x95, 0x16, 0x8D, 0x07, 0x09, 0x32, 0xAD, 0x40,
  0xB8, 0x15, 0xCB, 0x68, 0x6B, 0x31, 0x9A, 0xCF, 0x3C, 0xAC, 0xD9, 0x50, 0x5F, 0x98, 0x25, 0x84,
  0xC0, 0x16, 0x42, 0x47, 0x01, 0x42, 0x2B, 0xA6, 0x42, 0x6A, 0xB0, 0x2E, 0x8E, 0x95, 0x83, 0xCD,
  0x1C, 0x41, 0xC9, 0x6B, 0x07, 0x04, 0x4A, 0x07, 0x6F, 0x4E, 0x9E, 0x7E, 0xCB, 0x93, 0x6F, 0x72,
  0xE7, 0x8A, 0x6B, 0x78, 0x6A, 0xFD, 0x28, 0x30, 0x1D, 0x58, 0xE0, 0x8D, 0x51, 0x96, 0x6A, 0x51,
  0x2E, 0xAE, 0xB2, 0x9F, 0x5A, 0x35, 0xD2, 0x45, 0x8F, 0xEA, 0xA9, 0x5D, 0xE5, 0xFC, 0x5F, 0x17,
  0xE5, 0x49, 0x87, 0x02, 0x71, 0xA3, 0x0F, 0x84, 0x26, 0xA1, 0x2D, 0x6B, 0xB0, 0x8B, 0x35, 0xC5,
  0x80, 0x83, 0xEF, 0x6D, 0x58, 0x4F, 0xAD, 0x86, 0x99, 0x66, 0x5A, 0x49, 0xB2, 0x1B, 0xDF, 0x1B,
  0xE4, 0xF6, 0xFE, 0x76, 0x09, 0xE9, 0x4A, 0xBB, 0xA6, 0x31, 0xB4, 0xEE, 0x40, 0x50, 0x85, 0xF9,
  0x5A, 0x74, 0xAB, 0x27, 0x54, 0x6E, 0x6F, 0xF0, 0x0B, 0xC2, 0xF4, 0x85, 0xB8, 0xF7, 0xF3, 0xA8,
  0xEE, 0x8E, 0x1C, 0x5E, 0x9D, 0x1A, 0x96, 0xAF, 0xC7, 0x75, 0xF6, 0x18, 0xDE, 0x8F, 0xEB, 0xC2,
  0x9F, 0x8D, 0x0D, 0xC0, 0x6B, 0x7A, 0xD7, 0xEB, 0x71, 0xA2, 0x82, 0x5A, 0x98, 0xA4, 0x9A, 0x19,
  0xF0, 0xDA, 0x19, 0xA3, 0x7B, 0x67, 0x2C, 0xC4, 0x09, 0xEE, 0x7A, 0xEF, 0xEC, 0xBE, 0xB7, 0xCE,
  0xE4, 0x9A, 0xEF, 0x98, 0x42, 0x0B, 0xD7, 0xCE, 0x9F, 0xE1, 0xDD, 0x9B, 0x43, 0x08, 0x58, 0xA6,
  0xA5, 0x4B, 0x1C, 0xD3, 0xC2, 0x05, 0x35, 0x75, 0xEA, 0x8A, 0x3D, 0xC3, 0x52, 0xCF, 0xB0, 0xAE,
  0xA7, 0x86, 0x59, 0xBA, 0x6D, 0x66, 0x02, 0x29, 0xBC, 0x02, 0x0E, 0xA8, 0xDD, 0x77, 0xD0, 0x3A,
  0x98, 0xD3, 0xC5, 0xFF, 0x1B, 0x02, 0xE8, 0xAF, 0x8A, 0xCB, 0x1C, 0xD6, 0x13, 0xE7, 0x21, 0x06,
  0x0F, 0xED, 0xB7, 0xD5, 0x7D, 0xDA, 0xFD, 0x36, 0x7D, 0x06, 0x6B, 0xBF, 0x2D, 0xFE, 0x9F, 0x50,
  0xFF, 0x17, 0x60, 0x03, 0xF5, 0xB2, 0x20, 0x75, 0x00, 0x00,
};
static const size_t INDEX_HTML_GZ_LEN = 7914;

// --------------------------- HTTP Handlers ---------------------------
static void sendAndClose(int code, const char* contentType, const String& body) {
  // NOTE: Arduino WebServer is effectively single-client; browsers that keep a
  // persistent connection open can block other clients (e.g., phone can't load
  // while a PC tab is open). Force-close after every response.
  server.sendHeader("Cache-Control", "no-store");
  server.sendHeader("Connection", "close");
  server.send(code, contentType, body);
  server.client().stop();
}

static void sendJson(int code, const String& json) {
  sendAndClose(code, "application/json", json);
}

static void sendText(int code, const String& text) {
  sendAndClose(code, "text/plain", text);
}


// --------------------------- Config UI / Portal ---------------------------

static String htmlEscape(const String& in) {
  String out;
  out.reserve(in.length() + 8);
  for (size_t i = 0; i < in.length(); i++) {
    char c = in[i];
    switch (c) {
      case '&': out += "&amp;"; break;
      case '<': out += "&lt;"; break;
      case '>': out += "&gt;"; break;
      case '"': out += "&quot;"; break;
      case '\'': out += "&#39;"; break;
      default: out += c; break;
    }
  }
  return out;
}


static void sendHtml(int code, const String& html) {
  sendAndClose(code, "text/html", html);
}

static String configPageHtml(bool apMode, const String& banner) {
  // NOTE: Keep JS minimal to avoid breaking the main UI.
  String action = apMode ? "/save" : "/config/save";

  String ipMode = g_cfg.useDhcp ? "dhcp" : "static";

  String h;
  h.reserve(4200);
  h += "<!doctype html><html><head><meta charset='utf-8'/>";
  h += "<meta name='viewport' content='width=device-width,initial-scale=1'/>";
  h += "<title>BedJet ESP32 Setup</title>";
  h += "<style>";
  h += "body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:16px;}";
  h += ".card{max-width:720px;margin:0 auto;padding:14px;border:1px solid #ddd;border-radius:12px;}";
  h += "h1{font-size:20px;margin:0 0 10px 0;}";
  h += "label{display:block;margin:10px 0 6px;font-weight:600;}";
  h += "input,select{padding:10px;border:1px solid #bbb;border-radius:10px;max-width:100%;}";
  h += "input[type=text],input[type=password]{width:100%;box-sizing:border-box;}";
  h += ".row{display:flex;gap:10px;flex-wrap:wrap;}";
  h += ".row > div{flex:1;min-width:160px;}";
  h += ".btn{display:inline-block;padding:10px 14px;border-radius:12px;border:1px solid #0b5; background:#0b5;color:#fff;font-weight:700;cursor:pointer;}";
  h += ".btn2{display:inline-block;padding:10px 14px;border-radius:12px;border:1px solid #888; background:#fff;color:#111;font-weight:700;cursor:pointer;text-decoration:none;}";
  h += ".hint{opacity:.8;font-size:13px;margin-top:8px;line-height:1.35;}";
  h += ".banner{margin:10px 0;padding:10px;border-radius:10px;background:#f5f5f5;border:1px solid #ddd;white-space:pre-line;}";
  h += ".staticFields{margin-top:8px;}";
  h += "</style>";
  h += "</head><body><div class='card'>";
  h += "<h1>BedJet ESP32 Configuration</h1>";
  if (banner.length()) {
    h += "<div class='banner'>" + banner + "</div>";
  }
  if (apMode) {
    h += "<div class='hint'>You're connected to the setup AP. Enter your Wiâ€‘Fi and BedJet settings, then Save &amp; Reboot.</div>";
  } else {
    h += "<div class='hint'>Change settings, then Save &amp; Reboot.</div>";
  }

  h += "<form method='POST' action='" + action + "'>";

  h += "<label>Wiâ€‘Fi SSID</label>";
  h += "<input name='ssid' type='text' value='" + htmlEscape(g_cfg.wifiSsid) + "' required />";

  h += "<label>Wiâ€‘Fi Password</label>";
  h += "<input name='pass' type='password' value='' placeholder='(leave blank to keep current)' />";

  h += "<label>IP Mode</label>";
  h += "<select name='ipmode' id='ipmode'>";
  h += String("<option value='dhcp'") + (ipMode == "dhcp" ? " selected" : "") + ">DHCP (dynamic)</option>";
  h += String("<option value='static'") + (ipMode == "static" ? " selected" : "") + ">Static</option>";
  h += "</select>";

  h += "<div class='staticFields' id='staticFields'>";
  h += "<div class='row'>";
  h += "<div><label>Static IP</label><input name='ip' type='text' value='" + g_cfg.localIp.toString() + "' /></div>";
  h += "<div><label>Gateway</label><input name='gw' type='text' value='" + g_cfg.gateway.toString() + "' /></div>";
  h += "</div>";
  h += "<div class='row'>";
  h += "<div><label>Subnet</label><input name='sn' type='text' value='" + g_cfg.subnet.toString() + "' /></div>";
  h += "<div><label>DNS 1</label><input name='dns1' type='text' value='" + g_cfg.dns1.toString() + "' /></div>";
  h += "</div>";
  h += "<div class='row'>";
  h += "<div><label>DNS 2</label><input name='dns2' type='text' value='" + g_cfg.dns2.toString() + "' /></div>";
  h += "<div></div>";
  h += "</div>";
  h += "</div>";

  h += "<label>BedJet MAC</label>";
  h += "<input name='mac' type='text' value='" + htmlEscape(g_cfg.bedjetMac) + "' placeholder='AA:BB:CC:DD:EE:FF' />";

  h += "<label>Device Name</label>";
  h += "<input name='name' type='text' value='" + htmlEscape(g_cfg.deviceName) + "' />";

  h += "<label>Hostname (mDNS)</label>";
  h += "<input name='host' type='text' value='" + htmlEscape(g_cfg.hostName) + "' placeholder='BEDJETWEB' />";
  h += "<div class='hint'>After reboot you can usually open: <b>http://"+ htmlEscape(g_cfg.hostName) +".local/</b> (PC/iOS often work; Android varies). IP always works.</div>";

  h += "<div style='margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;'>";
  h += "<button class='btn' type='submit'>Save &amp; Reboot</button>";
  if (!apMode) h += "<a class='btn2' href='/'>Back</a>";
  h += "</div>";

  h += "<div class='hint'>Tip: hold the ESP32 <b>BOOT</b> button during powerâ€‘up to force setup AP mode.</div>";

  h += "</form>";

  // small JS: show/hide static fields; keep it simple and isolated
  h += "<script>";
  h += "function upd(){var m=document.getElementById('ipmode').value;var s=document.getElementById('staticFields');if(!s)return; s.style.display=(m==='static')?'block':'none';}";
  h += "document.getElementById('ipmode').addEventListener('change',upd);upd();";
  h += "</script>";

  h += "</div></body></html>";
  return h;
}

static bool applyConfigFromRequest(RuntimeConfig& outCfg) {
  RuntimeConfig c = g_cfg;

  String ssid = server.arg("ssid"); ssid.trim();
  if (ssid.length() == 0) return false;
  c.wifiSsid = ssid;

  String pass = server.arg("pass"); // may be blank (keep current)
  pass.trim();
  c.wifiPass = pass; // if blank, saveConfigToNvs will keep old

  String ipmode = server.arg("ipmode"); ipmode.trim(); ipmode.toLowerCase();
  c.useDhcp = (ipmode == "dhcp");

  if (!c.useDhcp) {
    IPAddress ip, gw, sn, d1, d2;
    String sip = server.arg("ip");  sip.trim();
    String sgw = server.arg("gw");  sgw.trim();
    String ssn = server.arg("sn");  ssn.trim();
    String sd1 = server.arg("dns1"); sd1.trim();
    String sd2 = server.arg("dns2"); sd2.trim();

    if (sip.length() && !parseIp(sip, ip)) return false;
    if (sgw.length() && !parseIp(sgw, gw)) return false;
    if (ssn.length() && !parseIp(ssn, sn)) return false;
    if (sd1.length() && !parseIp(sd1, d1)) return false;
    if (sd2.length() && !parseIp(sd2, d2)) return false;

    if (sip.length()) c.localIp = ip;
    if (sgw.length()) c.gateway = gw;
    if (ssn.length()) c.subnet = sn;
    if (sd1.length()) c.dns1 = d1;
    if (sd2.length()) c.dns2 = d2;
  }

  String mac = server.arg("mac");
  mac = normalizeMac(mac);
  if (mac.length()) {
    // allow blank, but if provided it must be valid-ish
    if (!isMacLikelyValid(mac)) return false;
    c.bedjetMac = mac;
  }

  String name = server.arg("name"); name.trim();
  if (name.length()) c.deviceName = name;

  String host = server.arg("host");
  host = normalizeHost(host);
  if (host.length()) c.hostName = host;

  outCfg = c;
  return true;
}

static String tryWifiAndGetIp(const RuntimeConfig& c, bool& ok) {
  ok = false;

  WiFi.disconnect(true, true);
  delay(200);

  WiFi.mode(WIFI_STA);
  WiFi.setSleep(false);

  if (!c.useDhcp) {
    WiFi.config(c.localIp, c.gateway, c.subnet, c.dns1, c.dns2);
  }

  WiFi.begin(c.wifiSsid.c_str(), (c.wifiPass.length() ? c.wifiPass.c_str() : g_cfg.wifiPass.c_str()));

  uint32_t start = millis();
  while (!WiFi.isConnected() && millis() - start < 9000) delay(250);

  if (!WiFi.isConnected()) return String("");

  ok = true;
  return WiFi.localIP().toString();
}

static void handleConfigGet(bool apMode) {
  sendHtml(200, configPageHtml(apMode, ""));
}


static void handleConfigSave(bool apMode) {
  RuntimeConfig newCfg;
  if (!applyConfigFromRequest(newCfg)) {
    sendHtml(400, configPageHtml(apMode, "Invalid input. Please check SSID / IP fields / MAC format."));
    return;
  }

  // Persist config (keep existing password if blank)
  saveConfigToNvs(newCfg, true);

  // Update runtime copy
  if (newCfg.wifiPass.length() == 0) newCfg.wifiPass = g_cfg.wifiPass;
  g_cfg = newCfg;

  String msg;
  msg.reserve(256);
  msg += "Saved configuration.\n";
  if (!g_cfg.useDhcp) {
    msg += "After reboot, browse: http://" + g_cfg.localIp.toString() + "/\n";
  } else {
    msg += "After reboot, the device will get an IP via DHCP.\n";
    msg += "Check Serial log or your router DHCP leases for the IP.\n";
  }
  msg += "If you\'re on a phone: when the setup Wiâ€‘Fi drops, reconnect to your home Wiâ€‘Fi SSID \"" + g_cfg.wifiSsid + "\" and then open the URL above.\n";
  msg += "Rebooting...";

  // IMPORTANT: Do not disrupt Wiâ€‘Fi before responding (or the browser will hang).
  sendHtml(200, configPageHtml(apMode, msg));
  scheduleRestart(apMode ? 4500 : 1500);
}

static void scheduleRestart(uint32_t delayMs) {
  g_pendingRestartAtMs = millis() + delayMs;
}

static void setupWebConfigPortal() {
  server.on("/", HTTP_GET, [](){ handleConfigGet(true); });
  server.on("/save", HTTP_POST, [](){ handleConfigSave(true); });

  // Captive portal: redirect everything to /
  server.onNotFound([](){
    server.sendHeader("Location", String("http://") + WiFi.softAPIP().toString() + "/");
    server.sendHeader("Connection", "close");
    server.send(302, "text/plain", "");
    server.client().stop();
  });

  server.begin();
}

static void setupWebNormalConfigPage() {
  server.on("/config", HTTP_GET, [](){ handleConfigGet(false); });
  server.on("/config/save", HTTP_POST, [](){ handleConfigSave(false); });
}

static void startConfigPortal() {
  g_configMode = true;

  WiFi.mode(WIFI_AP);
  uint32_t chip = (uint32_t)(ESP.getEfuseMac() & 0xFFFF);
  char ssid[32];
  snprintf(ssid, sizeof(ssid), "BedJetSetup-%04X", (unsigned int)chip);

  // Open AP (no password) to simplify first boot
  WiFi.softAP(ssid);

  IPAddress apIp = WiFi.softAPIP();
  g_dns.start(53, "*", apIp);

  setupWebConfigPortal();

  Serial.printf("[CFG] Setup AP started. SSID=%s  IP=%s\n", ssid, apIp.toString().c_str());
  Serial.printf("[CFG] Open http://%s/ in a browser\n", apIp.toString().c_str());
}
// --------------------------------------------------------------------------


static void handleRoot() {
  // Serve gzipped HTML to save flash space
  server.sendHeader("Cache-Control", "no-store");
  server.sendHeader("Content-Encoding", "gzip");
  server.sendHeader("Connection", "close");
  server.setContentLength(INDEX_HTML_GZ_LEN);
  server.send(200, "text/html", "");
  WiFiClient c = server.client();
  c.write_P((PGM_P)INDEX_HTML_GZ, INDEX_HTML_GZ_LEN);
  c.stop();
}

static void handleState() { sendJson(200, buildStateJson()); }

static void handleScheduleExport() { sendJson(200, buildScheduleExportJson()); }

static void handleScheduleImport() {
  String body = server.arg("plain");
  body.trim();
  if (body.length() == 0) { server.send(400, "text/plain", "empty body"); return; }

  ScheduleItem items[MAX_SCHEDULE];
  int count = 0;
  uint16_t nextId = 1;
  String err;
  if (!parseScheduleImport(body, items, count, nextId, err)) {
    server.send(400, "text/plain", err.length() ? err : "parse failed");
    return;
  }

  // Replace schedule
  g_schedCount = count;
  for (int i = 0; i < g_schedCount; i++) g_sched[i] = items[i];
  g_nextId = nextId;
  g_activeIndex = -1;

  saveSchedule();
  sendJson(200, String("{\"ok\":true,\"count\":") + String(count) + "}");
}


static void handleBleConnect() {
  bool ok = bleEnsureConnected();
  sendJson(ok ? 200 : 500, String("{\"ok\":") + (ok ? "true" : "false") + "}");
}

static void handleBleDisconnect() {
  bool ok = bleDisconnect();
  sendJson(ok ? 200 : 500, String("{\"ok\":") + (ok ? "true" : "false") + "}");
}

static void handleCmdButton() {
  // Quick Controls call this endpoint with optional fan/temp query params.
  // Example: /api/cmd/button?name=HEAT&fan=12&temp=92&runH=8&runM=0
  uint8_t btn = modeToBtn(server.arg("name"));

  bool ok = bleConnect();
  if (ok) ok = bedjetButton(btn);

  // If optional temp/fan provided, apply them too (tiny delays help BLE reliability).
  if (ok && server.hasArg("temp")) {
    float t = server.arg("temp").toFloat();
    delay(60);
    ok = bedjetSetTempF(t);
  }
  if (ok && server.hasArg("fan")) {
    int fan = server.arg("fan").toInt();
    delay(60);
    ok = bedjetSetFan((uint8_t)constrain(fan, (int)FAN_MIN, (int)FAN_MAX));
  }

  // Optional run-time (hours/minutes). If either is provided and total > 0, set runtime.
  if (ok && (server.hasArg("runH") || server.hasArg("runM"))) {
    int h = server.hasArg("runH") ? server.arg("runH").toInt() : 0;
    int m = server.hasArg("runM") ? server.arg("runM").toInt() : 0;
    h = constrain(h, 0, 11);
    m = constrain(m, 0, 59);
    uint16_t total = (uint16_t)(h * 60 + m);
    if (total > 0) {
      delay(60);
      ok = bedjetSetRuntimeMinutes(total);
    }
  }

  sendJson(ok ? 200 : 500, String("{\"ok\":") + (ok ? "true" : "false") + "}");
}

static void handleScheduleAdd() {
  if (g_schedCount >= MAX_SCHEDULE) { server.send(400, "text/plain", "Schedule full"); return; }

  uint16_t startMin = 0, stopMin = 0;
  if (!tryGetMinArg("startMin", startMin)) { server.send(400, "text/plain", "Invalid startMin"); return; }
  if (!tryGetMinArg("stopMin", stopMin))   { server.send(400, "text/plain", "Invalid stopMin"); return; }
  if (startMin == stopMin) { server.send(400, "text/plain", "Start and stop cannot be the same"); return; }

  uint8_t btn = modeToBtn(server.arg("mode"));
  int fan = server.arg("fan").toInt();
  float temp = server.arg("temp").toFloat();
  bool enabled = server.arg("enabled").toInt() != 0;

  ScheduleItem it{};
  it.id = g_nextId++;
  it.modeButton = btn;
  it.fanStep = (uint8_t)constrain(fan, (int)FAN_MIN, (int)FAN_MAX);
  it.tempF = temp;
  it.startMin = startMin;
  it.stopMin = stopMin;
  it.enabled = enabled;

  g_sched[g_schedCount++] = it;
  saveSchedule();
  sendJson(200, "{\"ok\":true}");
}

static void handleScheduleUpdate() {
  String idStr = server.arg("id");
  idStr.trim();
  if (idStr.length() == 0) { server.send(400, "text/plain", "Missing id"); return; }
  uint16_t id = (uint16_t)idStr.toInt();

  int idx = -1;
  for (int i = 0; i < g_schedCount; i++) {
    if (g_sched[i].id == id) { idx = i; break; }
  }
  if (idx < 0) { server.send(404, "text/plain", "Not found"); return; }

  uint16_t startMin = 0, stopMin = 0;
  if (!tryGetMinArg("startMin", startMin)) { server.send(400, "text/plain", "Invalid startMin"); return; }
  if (!tryGetMinArg("stopMin", stopMin))   { server.send(400, "text/plain", "Invalid stopMin"); return; }
  if (startMin == stopMin) { server.send(400, "text/plain", "Start and stop cannot be the same"); return; }

  uint8_t btn = modeToBtn(server.arg("mode"));
  int fan = server.arg("fan").toInt();
  float temp = server.arg("temp").toFloat();
  bool enabled = server.arg("enabled").toInt() != 0;

  g_sched[idx].modeButton = btn;
  g_sched[idx].fanStep = (uint8_t)constrain(fan, (int)FAN_MIN, (int)FAN_MAX);
  g_sched[idx].tempF = temp;
  g_sched[idx].startMin = startMin;
  g_sched[idx].stopMin = stopMin;
  g_sched[idx].enabled = enabled;

  saveSchedule();
  sendJson(200, "{\"ok\":true}");
}

static void handleScheduleDeleteOne() {
  String idStr = server.arg("id");
  idStr.trim();
  if (idStr.length() == 0) { server.send(400, "text/plain", "Missing id"); return; }
  uint16_t id = (uint16_t)idStr.toInt();

  int idx = -1;
  for (int i = 0; i < g_schedCount; i++) {
    if (g_sched[i].id == id) { idx = i; break; }
  }
  if (idx < 0) { server.send(404, "text/plain", "Not found"); return; }

  for (int i = idx; i < g_schedCount - 1; i++) g_sched[i] = g_sched[i + 1];
  g_schedCount--;

  if (g_activeIndex == idx) g_activeIndex = -1;
  else if (g_activeIndex > idx) g_activeIndex--;

  saveSchedule();
  sendJson(200, "{\"ok\":true}");
}

// --------------------------- Setup / Loop ---------------------------


static bool setupWiFi() {
  WiFi.mode(WIFI_STA);
  WiFi.setSleep(false);

  if (!g_cfg.useDhcp) {
    Serial.printf("[WIFI] Static IP configured: %s (gw=%s sn=%s)\n",
                  g_cfg.localIp.toString().c_str(),
                  g_cfg.gateway.toString().c_str(),
                  g_cfg.subnet.toString().c_str());
    WiFi.config(g_cfg.localIp, g_cfg.gateway, g_cfg.subnet, g_cfg.dns1, g_cfg.dns2);
  }

  String host = normalizeHost(g_cfg.hostName);
  String hostLower = host; hostLower.toLowerCase();
  WiFi.setHostname(hostLower.c_str());

  WiFi.begin(g_cfg.wifiSsid.c_str(), g_cfg.wifiPass.c_str());

  uint32_t start = millis();
  while (!WiFi.isConnected() && millis() - start < 15000) delay(250);

  if (WiFi.isConnected()) {
    Serial.printf("[WIFI] Connected. IP=%s\n", WiFi.localIP().toString().c_str());
    // mDNS: http://<hostname>.local/
    String host = normalizeHost(g_cfg.hostName);
    String hostLower = host; hostLower.toLowerCase();
    if (MDNS.begin(hostLower.c_str())) {
      MDNS.addService("http", "tcp", 80);
      Serial.printf("[MDNS] http://%s.local/\n", hostLower.c_str());
    } else {
      Serial.println("[MDNS] begin failed");
    }
  } else {
    Serial.printf("[WIFI] Connect timeout (SSID=%s)\n", g_cfg.wifiSsid.c_str());
  }

  return WiFi.isConnected();
}

static void setupTimeNtp() {
  // Get UTC first
  configTime(0, 0, "pool.ntp.org", "time.nist.gov", "time.google.com");

  // Apply US Eastern TZ (handles EST/EDT automatically)
  setenv("TZ", "EST5EDT,M3.2.0/2,M11.1.0/2", 1);
  tzset();
}

static void setupBle() {
  NimBLEDevice::init("BedJetESP32");
  NimBLEDevice::setPower(ESP_PWR_LVL_P9);
  NimBLEDevice::setSecurityAuth(false, false, false);
}

static void setupWeb() {
  server.on("/", HTTP_GET, handleRoot);
  server.on("/api/state", HTTP_GET, handleState);

  server.on("/api/ble/connect", HTTP_POST, handleBleConnect);
  server.on("/api/ble/disconnect", HTTP_POST, handleBleDisconnect);

  server.on("/api/cmd/button", HTTP_POST, handleCmdButton);

  server.on("/api/schedule/add", HTTP_POST, handleScheduleAdd);
  server.on("/api/schedule/update", HTTP_POST, handleScheduleUpdate);
  server.on("/api/schedule/deleteOne", HTTP_POST, handleScheduleDeleteOne);
  server.on("/api/schedule/export", HTTP_GET, handleScheduleExport);
  server.on("/api/schedule/import", HTTP_POST, handleScheduleImport);

  setupWebNormalConfigPage();

  server.begin();
}


void setup() {
  Serial.begin(115200);
  delay(200);

  // BOOT button (GPIO0) held low at boot forces config portal
  pinMode(0, INPUT_PULLUP);
  bool forceCfg = (digitalRead(0) == LOW);

  loadSchedule();
  bool hasCfg = loadConfig();

  if (forceCfg || !hasCfg) {
    startConfigPortal();
    return;
  }

  // IMPORTANT: Keep setup non-blocking so the web server becomes responsive quickly.
  // - We allow up to ~15s for Wi-Fi association.
  // - We do NOT block waiting on NTP.
  // If Wi-Fi fails, fall back to Setup AP automatically so you can recover on phone/PC.
  bool wifiOk = setupWiFi();
  if (!wifiOk) {
    Serial.println("[WIFI] Not connected. Falling back to setup AP portal.");
    startConfigPortal();
    return;
  }

  setupWeb();
  setupTimeNtp();
  setupBle();
}


void loop() {
  // Pending restart (used by config portal & config page)
  if (g_pendingRestartAtMs && (int32_t)(millis() - g_pendingRestartAtMs) >= 0) {
    delay(50);
    ESP.restart();
  }

  // Config portal mode: only serve captive portal
  if (g_configMode) {
    g_dns.processNextRequest();
    server.handleClient();
    delay(5);
    return;
  }

  server.handleClient();

  // keep BLE state honest
  if (g_client && g_bleConnected && !g_client->isConnected()) {
    g_bleConnected = false;
    bleClearHandles();
  }

  // scheduler tick (every 2s)
  uint32_t now = millis();
  if (now - g_lastSchedulerTickMs >= 2000) {
    g_lastSchedulerTickMs = now;
    schedulerTick();
  }

  delay(5);
}
